   /*******************************************************/
   /*      "C" Language Integrated Production System      */
   /*                                                     */
   /*             CLIPS Version 6.20  01/31/02            */
   /*                                                     */
   /*                 I/O FUNCTIONS MODULE                */
   /*******************************************************/

/*************************************************************/
/* Purpose: Contains the code for several I/O functions      */
/*   including printout, read, open, close, remove, rename,  */
/*   format, and readline.                                   */
/*                                                           */
/* Principal Programmer(s):                                  */
/*      Brian L. Donnell                                     */
/*      Gary D. Riley                                        */
/*      Bebe Ly                                              */
/*                                                           */
/* Contributing Programmer(s):                               */
/*                                                           */
/* Revision History:                                         */
/*                                                           */
/*************************************************************/

#define _IOFUN_SOURCE_

#include <windows.h>
#include <stdio.h>
#include <math.h>
#define _STDIO_INCLUDED_
#include <string.h>

#include "setup.h"
#include "multifld.h"
#include "envrnmnt.h"
#include "router.h"
#include "strngrtr.h"
#include "filertr.h"
#include "argacces.h"
#include "extnfunc.h"
#include "scanner.h"
#include "constant.h"
#include "memalloc.h"
#include "commline.h"
#include "sysdep.h"
#include "utility.h"
#include "insfile.h"
#include "insfun.h"
#include "inscom.h"
#include "insmngr.h"
#include "insmoddp.h"
#include "insmult.h"
#include "inspsr.h"

#include "iofun.h"

#include "Markowitz.h"

/***************/
/* DEFINITIONS */
/***************/

#define FORMAT_MAX 512
#define FLAG_MAX    80

/****************************************/
/* LOCAL INTERNAL FUNCTION DEFINITIONS  */
/****************************************/

#if BASIC_IO
   static void             ReadTokenFromStdin(void *,struct token *);
#endif
#if BASIC_IO || EXT_IO
   static void             IllegalLogicalNameMessage(void *,char *);
#endif
#if EXT_IO
   static char            *ControlStringCheck(void *,int);
   static char             FindFormatFlag(char *,unsigned *,char *,int *);
   static char            *PrintFormatFlag(void *,char *,int,int,int);
   static char            *FillBuffer(void *,char *,int *,unsigned *);
#endif

/**************************************/
/* IOFunctionDefinitions: Initializes */
/*   the I/O functions.               */
/**************************************/
globle void IOFunctionDefinitions(
  void *theEnv)
  {
#if ! RUN_TIME
#if BASIC_IO
   EnvDefineFunction2(theEnv,"printout", 'v', PTIEF PrintoutFunction, "PrintoutFunction", "1*");
   EnvDefineFunction2(theEnv,"read",     'u', PTIEF ReadFunction,  "ReadFunction", "*1");
   EnvDefineFunction2(theEnv,"open",     'b', OpenFunction,  "OpenFunction", "23*k");
   EnvDefineFunction2(theEnv,"close",    'b', CloseFunction, "CloseFunction", "*1");
   EnvDefineFunction2(theEnv,"Message",    'v', Message, "MessageFunction", "22");
   EnvDefineFunction2(theEnv,"WriteToBlackboard",    'v', WriteToBlackboard, "WriteToBlackboardFunction", "22");
   EnvDefineFunction2(theEnv,"CalculateMarkowitz",    'v', CalculateMarkowitz, "CalculateMarkowitz", "33");
   EnvDefineFunction2(theEnv,"AddPapel",    'v', AddPapel, "AddPapel", "11");
   EnvDefineFunction2(theEnv,"AddQuote",    'v', AddQuote, "AddQuote", "33");
   EnvDefineFunction2(theEnv,"AddEstimativaRetorno",    'v', AddEstimativaRetorno, "AddEstimativaRetorno", "33");
   EnvDefineFunction2(theEnv,"LogCLIPS",    'v', LogCLIPS, "LogCLIPS", "11");
#endif

#if EXT_IO
   EnvDefineFunction2(theEnv,"remove",   'b', RemoveFunction,  "RemoveFunction", "11k");
   EnvDefineFunction2(theEnv,"rename",   'b', RenameFunction, "RenameFunction", "22k");
   EnvDefineFunction2(theEnv,"format",   's', PTIEF FormatFunction, "FormatFunction", "2**us");
   EnvDefineFunction2(theEnv,"readline", 'k', PTIEF ReadlineFunction, "ReadlineFunction", "*1");
#endif
#else
#if MAC_MPW || MAC_MCW || IBM_MCW
#pragma unused(theEnv)
#endif
#endif
  }

#if BASIC_IO

/******************************************/
/* PrintoutFunction: H/L access routine   */
/*   for the printout function.           */
/******************************************/
globle void PrintoutFunction(
  void *theEnv)
  {
   char *dummyid;
   char Temp[1000];
   int i, argCount;
   DATA_OBJECT theArgument;

   /*=======================================================*/
   /* The printout function requires at least one argument. */
   /*=======================================================*/

   if ((argCount = EnvArgCountCheck(theEnv,"printout",AT_LEAST,1)) == -1) return;

   /*=====================================================*/
   /* Get the logical name to which output is to be sent. */
   /*=====================================================*/

   dummyid = GetLogicalName(theEnv,1,"stdout");
   if (dummyid == NULL)
     {
      IllegalLogicalNameMessage(theEnv,"printout");
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      return;
     }

   /*============================================================*/
   /* Determine if any router recognizes the output destination. */
   /*============================================================*/

   if (strcmp(dummyid,"nil") == 0)
     { return; }
   else if (QueryRouters(theEnv,dummyid) == FALSE)
     {
      UnrecognizedRouterMessage(theEnv,dummyid);
      return;
     }

   /*===============================================*/
   /* Print each of the arguments sent to printout. */
   /*===============================================*/

   for (i = 2; i <= argCount; i++)
     {
      EnvRtnUnknown(theEnv,i,&theArgument);
      if (EvaluationData(theEnv)->HaltExecution) break;

      switch(GetType(theArgument))
        {
         case SYMBOL:
           if (strcmp(DOToString(theArgument),"crlf") == 0)
             { EnvPrintRouter(theEnv,dummyid,"\n"); }
           else if (strcmp(DOToString(theArgument),"tab") == 0)
             { EnvPrintRouter(theEnv,dummyid,"\t"); }
           else if (strcmp(DOToString(theArgument),"vtab") == 0)
             { EnvPrintRouter(theEnv,dummyid,"\v"); }
           else if (strcmp(DOToString(theArgument),"ff") == 0)
             { EnvPrintRouter(theEnv,dummyid,"\f"); }
           else if (strcmp(DOToString(theArgument),"t") == 0)
             { EnvPrintRouter(theEnv,dummyid,"\n"); }
           else
             { EnvPrintRouter(theEnv,dummyid,DOToString(theArgument)); }
           break;

         case STRING:
           strcpy(Temp,DOToString(theArgument));
		   EnvPrintRouter(theEnv,dummyid,DOToString(theArgument));
           break;

         default:
           PrintDataObject(theEnv,dummyid,&theArgument);
           break;
        }
     }
  }

/*************************************************************/
/* ReadFunction: H/L access routine for the read function.   */
/*************************************************************/
globle void ReadFunction(
  void *theEnv,
  DATA_OBJECT_PTR returnValue)
  {
   struct token theToken;
   int numberOfArguments;
   char *logicalName = NULL;

   /*===============================================*/
   /* Check for an appropriate number of arguments. */
   /*===============================================*/

   if ((numberOfArguments = EnvArgCountCheck(theEnv,"read",NO_MORE_THAN,1)) == -1)
     {
      returnValue->type = STRING;
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
      return;
     }

   /*======================================================*/
   /* Determine the logical name from which input is read. */
   /*======================================================*/

   if (numberOfArguments == 0)
     { logicalName = "stdin"; }
   else if (numberOfArguments == 1)
     {
      logicalName = GetLogicalName(theEnv,1,"stdin");
      if (logicalName == NULL)
        {
         IllegalLogicalNameMessage(theEnv,"read");
         SetHaltExecution(theEnv,TRUE);
         SetEvaluationError(theEnv,TRUE);
         returnValue->type = STRING;
         returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
         return;
        }
     }

   /*============================================*/
   /* Check to see that the logical name exists. */
   /*============================================*/

   if (QueryRouters(theEnv,logicalName) == FALSE)
     {
      UnrecognizedRouterMessage(theEnv,logicalName);
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      returnValue->type = STRING;
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
      return;
     }

   /*=======================================*/
   /* Collect input into string if the read */
   /* source is stdin, else just get token. */
   /*=======================================*/

   if (strcmp(logicalName,"stdin") == 0)
     { ReadTokenFromStdin(theEnv,&theToken); }
   else
     { GetToken(theEnv,logicalName,&theToken); }

   RouterData(theEnv)->CommandBufferInputCount = -1;

   /*====================================================*/
   /* Copy the token to the return value data structure. */
   /*====================================================*/

   returnValue->type = theToken.type;
   if ((theToken.type == FLOAT) || (theToken.type == STRING) ||
#if OBJECT_SYSTEM
       (theToken.type == INSTANCE_NAME) ||
#endif
       (theToken.type == SYMBOL) || (theToken.type == INTEGER))
     { returnValue->value = theToken.value; }
   else if (theToken.type == STOP)
     {
      returnValue->type = SYMBOL;
      returnValue->value = (void *) EnvAddSymbol(theEnv,"EOF");
     }
   else if (theToken.type == UNKNOWN_VALUE)
     {
      returnValue->type = STRING;
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
     }
   else
     {
      returnValue->type = STRING;
      returnValue->value = (void *) EnvAddSymbol(theEnv,theToken.printForm);
     }

   return;
  }

/********************************************************/
/* ReadTokenFromStdin: Special routine used by the read */
/*   function to read a token from standard input.      */
/********************************************************/
static void ReadTokenFromStdin(
  void *theEnv,
  struct token *theToken)
  {
   char *inputString;
   unsigned inputStringSize;
   int inchar;

   /*=============================================*/
   /* Continue processing until a token is found. */
   /*=============================================*/

   theToken->type = STOP;
   while (theToken->type == STOP)
     {
      /*===========================================*/
      /* Initialize the variables used for storing */
      /* the characters retrieved from stdin.      */
      /*===========================================*/

      inputString = NULL;
      RouterData(theEnv)->CommandBufferInputCount = 0;
      inputStringSize = 0;
      inchar = EnvGetcRouter(theEnv,"stdin");

      /*========================================================*/
      /* Continue reading characters until a carriage return is */
      /* entered or the user halts execution (usually with      */
      /* control-c). Waiting for the carriage return prevents   */
      /* the input from being prematurely parsed (such as when  */
      /* a space is entered after a symbol has been typed).     */
      /*========================================================*/

      while ((inchar != '\n') && (inchar != '\r') && (inchar != EOF) &&
             (! GetHaltExecution(theEnv)))
        {
         inputString = ExpandStringWithChar(theEnv,inchar,inputString,&RouterData(theEnv)->CommandBufferInputCount,
                                            &inputStringSize,inputStringSize + 80);
         inchar = EnvGetcRouter(theEnv,"stdin");
        }

      /*==================================================*/
      /* Open a string input source using the characters  */
      /* retrieved from stdin and extract the first token */
      /* contained in the string.                         */
      /*==================================================*/

      OpenStringSource(theEnv,"read",inputString,0);
      GetToken(theEnv,"read",theToken);
      CloseStringSource(theEnv,"read");
      if (inputStringSize > 0) rm(theEnv,inputString,inputStringSize);

      /*===========================================*/
      /* Pressing control-c (or comparable action) */
      /* aborts the read function.                 */
      /*===========================================*/

      if (GetHaltExecution(theEnv))
        {
         theToken->type = STRING;
         theToken->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
        }

      /*====================================================*/
      /* Return the EOF symbol if the end of file for stdin */
      /* has been encountered. This typically won't occur,  */
      /* but is possible (for example by pressing control-d */
      /* in the UNIX operating system).                     */
      /*====================================================*/

      if ((theToken->type == STOP) && (inchar == EOF))
        {
         theToken->type = SYMBOL;
         theToken->value = (void *) EnvAddSymbol(theEnv,"EOF");
        }
     }
  }

/*************************************************************/
/* OpenFunction: H/L access routine for the open function.   */
/*************************************************************/
globle int OpenFunction(
  void *theEnv)
  {
   int numberOfArguments;
   char *fileName, *logicalName, *accessMode = NULL;
   DATA_OBJECT theArgument;

   /*========================================*/
   /* Check for a valid number of arguments. */
   /*========================================*/

   if ((numberOfArguments = EnvArgRangeCheck(theEnv,"open",2,3)) == -1) return(0);

   /*====================*/
   /* Get the file name. */
   /*====================*/

   if ((fileName = GetFileName(theEnv,"open",1)) == NULL) return(0);

   /*=======================================*/
   /* Get the logical name to be associated */
   /* with the opened file.                 */
   /*=======================================*/

   logicalName = GetLogicalName(theEnv,2,NULL);
   if (logicalName == NULL)
     {
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      IllegalLogicalNameMessage(theEnv,"open");
      return(0);
     }

   /*==================================*/
   /* Check to see if the logical name */
   /* is already in use.               */
   /*==================================*/

   if (FindFile(theEnv,logicalName))
     {
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      PrintErrorID(theEnv,"IOFUN",2,FALSE);
      EnvPrintRouter(theEnv,WERROR,"Logical name ");
      EnvPrintRouter(theEnv,WERROR,logicalName);
      EnvPrintRouter(theEnv,WERROR," already in use.\n");
      return(0);
     }

   /*===========================*/
   /* Get the file access mode. */
   /*===========================*/

   if (numberOfArguments == 2)
     { accessMode = "r"; }
   else if (numberOfArguments == 3)
     {
      if (EnvArgTypeCheck(theEnv,"open",3,STRING,&theArgument) == FALSE) return(0);
      accessMode = DOToString(theArgument);
     }

   /*=====================================*/
   /* Check for a valid file access mode. */
   /*=====================================*/

   if ((strcmp(accessMode,"r") != 0) &&
       (strcmp(accessMode,"r+") != 0) &&
       (strcmp(accessMode,"w") != 0) &&
       (strcmp(accessMode,"a") != 0) &&
       (strcmp(accessMode,"wb") != 0))
     {
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      ExpectedTypeError1(theEnv,"open",3,"string with value \"r\", \"r+\", \"w\", \"wb\", or \"a\"");
      return(0);
     }

   /*================================================*/
   /* Open the named file and associate it with the  */
   /* specified logical name. Return TRUE if the     */
   /* file was opened successfully, otherwise FALSE. */
   /*================================================*/

   return(OpenAFile(theEnv,fileName,accessMode,logicalName));
  }

/***************************************************************/
/* CloseFunction: H/L access routine for the close function.   */
/***************************************************************/
/*extern "C"  */ void addAnalisysMade(char *Mess);

globle int LogCLIPS(void *theEnv){
    FILE *templog;
	DATA_OBJECT theResult;
	char Temp         [10000];

	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));

	templog=fopen("C:\\logCLIPS.txt","a");
	fprintf(templog,"%s\r\n",Temp);
	fclose(templog);
	return 0;
}

globle int AddPapel(void *theEnv){
	DATA_OBJECT theResult;
	char Temp         [10000];

	
	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));
	AddNewPapel(atoi(Temp));
	return 0;

}

globle int AddQuote(void *theEnv){
	DATA_OBJECT theResult;
	char Temp         [10000];
	char Temp2        [10000];
	char Temp3        [10000];

	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));
	EnvRtnUnknown(theEnv,2,&theResult);
	sprintf(Temp2,"%s",DOToString(theResult));
	EnvRtnUnknown(theEnv,3,&theResult);
	sprintf(Temp3,"%s",DOToString(theResult));

	AddNewQuote(atoi(Temp),atoi(Temp2),atof(Temp3));
	return 0;
}


globle int AddEstimativaRetorno(void *theEnv){
	DATA_OBJECT theResult;
	char Temp         [10000];
	char Temp2        [10000];
	char Temp3        [10000];

	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));
	EnvRtnUnknown(theEnv,2,&theResult);
	sprintf(Temp2,"%s",DOToString(theResult));
	EnvRtnUnknown(theEnv,3,&theResult);
	sprintf(Temp3,"%s",DOToString(theResult));

	AddNewEstimativaRetorno(atoi(Temp),atoi(Temp2),atof(Temp3));
	return 0;
}

globle int CalculateMarkowitzAntigo(void *theEnv){
    DATA_OBJECT ret2;
	int f,g;
	char Temp4[1000];
    struct multifield *theMultifield;
	INSTANCE_TYPE *ins;
	struct field *tt;
	struct symbolHashNode *tt2;
	INSTANCE_TYPE *tmpIPtr, *nextIPtr;

	tmpIPtr = InstanceData(theEnv)->InstanceList;
	OutputDebugString(tmpIPtr->cls->header.name->contents);

	f=Eval(theEnv,"(+ 3 1)",&ret2);
	g=DOToInteger(ret2);
	f=Eval(theEnv,"(find-all-instances ((?p PREGAO)) (> ?p:Timestamp 5)))",&ret2);    
    theMultifield = (struct multifield *) GetpValue(&ret2);
	strcpy(Temp4,ValueToString(GetMFValue(theMultifield,1)));
	tt2=(struct symbolHashNode *)(GetMFValue(theMultifield,1));
/*	(GetMFValue(theMultifield,1)
	PrintInstanceNameAndClass*/
	return 0;
}

int count=0;
int Combinacao=0,currentCombinacao=0;

char TempStr[1000],TempStr2[100];

extern Papeis myPapeis;

int CalcularPorcentagens(int Nivel,int *Porc){
	int f,g,Tot;

	
		if(Nivel==myPapeis.NumeroPapeis){
			Tot=0;
			TempStr[0]=0;
			for(g=1;g<myPapeis.NumeroPapeis+1;g++){
				Tot+=Porc[g];
			}
			if(Tot==100 && currentCombinacao==Combinacao){
				return 1;
			}else{
				if(Tot==100){
					currentCombinacao++;
				}
			}
			return 0;
		}else{	       
			for(f=0;f<100;f+=5){			
				Porc[Nivel+1]=f;			
				if(CalcularPorcentagens(Nivel+1,Porc)) return 1;
			}
		}


}

int ValoresRandomicos[]=
{
8845,9740,3251,8507,2250,1862,2377,7157,717,5711
,5579,5804,2512,9617,8491,5676,9580,867,9879,8593
,2080,2108,2428,4630,5417,255,6019,2269,9769,7895
,3511,1056,2121,7198,9023,6758,797,6318,8715,9020
,2490,8303,4071,1519,1792,2499,7677,4622,3228,8458
,1502,542,5785,2342,7684,992,9945,5832,1807,7345
,7214,7531,8684,3290,2157,6875,637,9982,6925,533
,8279,3708,8288,1318,3796,6036,7168,9593,6728,6472
,667,7174,2248,7620,6601,3741,1946,2835,529,5738
,7109,6380,5287,7785,4504,6083,3016,6583,4655,8492
,9696,7318,2630,6534,2175,2568,1317,9666,7703,3710
,7208,6537,5961,4828,8680,140,3592,9116,6777,5471
,1234,7784,8488,9684,3050,1469,2534,4748,8760,4136
,7642,2601,8172,9486,3331,2809,8213,9865,3195,2723
,2460,7664,678,129,3171,9233,7361,8414,5820,1281
,3739,4213,6120,9785,2507,7571,9565,1396,4336,4596
,3452,7346,6157,2619,1417,9851,1945,7847,464,1022
,5994,5518,500,4267,8702,2562,6360,8201,4852,2755
,2346,3048,4395,4374,9252,9551,5727,353,3896,378
,1472,942,1154,4024,6766,8861,8492,1224,34,6959
,2991,3851,6275,8364,886,6331,2841,9148,9591,9544
,7718,3476,2235,7229,308,1265,4690,4897,4711,8342
,5103,1228,5505,9096,5929,1985,6029,1639,8460,6417
,9161,5458,9856,6165,602,1575,2681,6669,4659,5199
,6926,1075,2519,889,4548,6638,3039,201,6498,3633
,6021,1851,2251,6758,7997,4372,1839,9040,509,1265
,383,8244,887,8657,5123,5777,5537,5461,4947,8094
,5717,6028,2427,606,5819,5306,8348,4086,4151,6492
,8738,3573,6221,1193,4401,9780,512,2082,2947,3001
,6769,8051,3325,9516,6776,1868,2852,498,7643,337
,6746,3417,7578,6948,157,5951,4180,7040,2697,2386
,5208,5451,5473,2529,1873,6680,616,3108,4611,7539
,3315,1682,1371,2310,6347,3047,8391,404,7108,8142
,3481,6513,7142,5452,1806,3270,4179,4921,4164,6403
,6658,4351,7771,2392,765,8313,9538,8625,9958,9553
,1857,6055,7006,2894,878,4356,8513,1649,7293,9577
,1951,6520,9615,4304,5197,7011,9961,308,8555,5329
,2334,3708,9293,2793,3402,2626,8676,8739,5780,7339
,1491,1929,3813,2942,8082,4451,1853,4499,8883,8134
,5045,4700,1446,3446,2606,4020,9973,906,3607,3373
,7347,4988,5253,9268,9666,524,3665,1465,3270,1619
,7162,3136,4276,3047,2040,3514,606,4165,857,3053
,6522,5315,3209,1085,9654,6732,9018,5976,532,9951
,4307,7779,4618,1709,9483,3394,6837,358,122,4224
,8608,4764,245,6328,7375,5720,8102,3082,8640,9847
,4453,330,492,6004,3349,4045,638,4190,5413,482
,5938,6956,3622,8837,4431,3306,1587,6400,9870,5106
,4335,6213,8753,5988,1592,7228,9852,2761,3561,6959
,6247,9312,9204,6643,9854,3014,7026,8892,8461,3634
,8353,7853,5252,4736,3115,1861,847,7591,8126,8598
,7828,7581,7867,2746,7768,3103,7766,6147,770,6982
,9979,458,7489,370,1673,2304,3673,9157,5804,939
,7184,2874,4402,8400,7538,6102,4349,2163,7931,2377
,5664,300,9772,595,2281,9135,9715,3922,5329,3399
,9189,1196,8920,8890,6429,836,8421,7625,1009,7246
,1244,5498,870,9724,120,2435,1857,3867,8887,5055
,9743,5475,764,1819,4766,6962,9138,692,8657,6257
,844,9296,4174,8215,1945,7570,7129,8521,6012,2920
,926,93,4909,7881,3583,1997,2072,272,7272,843
,8290,5850,347,4699,9986,3467,1871,9493,2,2730
,8656,7921,873,4151,4786,852,616,1808,3652,1237
,1007,8500,2485,511,8362,3402,9384,7504,6819,2222
,2847,9843,4121,9860,3804,7861,9895,5557,151,1001
,6434,561,3774,6725,1979,8276,88,1919,6498,6918
,61,6798,9970,4679,4751,1313,3164,7372,2336,4059
,924,8599,7642,3680,7943,2398,4179,2773,7052,8402
,8668,4299,9998,9499,8075,483,724,1983,9142,4228
,1151,8212,416,3015,9462,1768,6784,5310,880,5105
,6501,9474,949,9715,721,5166,1318,8776,5532,7249
,8020,2314,6484,2199,2256,4855,5620,7008,3670,5585
,1011,593,6139,1003,8783,7701,6047,80,7648,5316
,3070,1913,5942,1561,3457,5882,1146,7113,5809,4307
,1927,9100,9362,7605,2661,7513,4769,1942,473,4111
,7381,9395,4758,3826,3023,603,9222,8670,6286,9928
,6406,4142,1298,3107,4721,8133,5011,7412,7980,2334
,2978,4304,7425,6139,7640,4588,6264,3054,9102,6072
,6695,9605,8418,3724,9445,6738,3368,2324,5796,3732
,6743,1624,2118,4602,7127,4002,6901,7003,2172,4619
,285,3641,4388,4078,6091,6178,9416,3575,6352,1635
,6816,2559,8349,1303,3344,8886,4134,2144,8734,1480
,2568,702,3980,5480,3849,9507,2117,9908,6545,5982
,1504,7815,7124,3847,1601,8943,1985,7030,1254,4879
,1991,6068,9475,6714,9498,7016,8722,5194,7888,2854
,684,3382,3600,7390,4559,1810,660,1671,7833,6139
,7715,2883,9569,7312,7559,5765,6180,4210,9171,6508
,9715,8813,2241,9166,8639,3849,4204,4559,1114,2958
,9769,1682,782,3343,2955,1611,5042,926,1615,3905
,5837,8008,4472,5520,2929,3423,652,2207,9687,5193
,1710,2424,1362,5688,6165,3740,5872,9279,6529,1742
,7083,2493,8841,1441,589,6675,4695,1175,1993,3139
,5775,9023,7690,826,881,1704,8147,6460,5467,5985
,3684,7204,3667,2590,2757,5818,2826,2605,2737,8314
,537,6380,3191,4111,4165,4942,1668,8692,2883,3896
,1974,8764,2203,9837,4956,9906,1003,9247,1786,6735
,1066,9912,9735,5555,9102,4820,464,9515,1287,8571
,795,6268,289,6283,6001,8123,4804,4998,5582,4706
,1581,7587,1547,8111,9961,9159,9198,561,8901,5963
,407,4562,6511,6800,9402,5559,2079,6925,1044,7091
,609,4452,1610,8452,9848,9265,2075,4843,9820,4422
,3892,28,4852,59,7275,1494,8113,9801,1977,8104
,8638,9664,574,253,864,9463,4247,2528,6660,6717
,1060,8859,9856,3059,6743,180,3278,3138,7975,4583
,8276,6026,8162,9972,6758,9126,5720,9225,5720,4577
,4856,7846,4275,8162,8849,4120,3189,712,5833,1775
,6907,2011,7075,5132,8089,7207,7758,6764,4639,5714
,265,7655,9235,2622,9954,9850,1362,2599,3445,1617
,1845,6299,9397,5100,9876,9270,1794,6476,2547,3359
,5722,8612,6883,617,5650,6221,4372,9706,6217,3517
,7995,4807,5506,4372,1758,7024,830,4975,2727,8291
,7012,8982,5551,7779,7164,5179,9502,801,5972,7633
,8001,218,5476,8352,651,349,3350,2440,7766,3370
,3682,5750,7407,8228,262,5047,4909,2044,2354,659
,4914,4016,2984,1633,5900,1830,9718,3395,7217,566
,7946,7904,8615,4101,6659,6308,2273,9018,6735,4100
,7335,1011,1716,8777,6940,3791,1094,9992,7750,493
,6087,2214,1986,7584,7923,9881,1955,1264,8622,5061
,7083,6379,4277,7601,3449,7821,832,7791,5811,4439
,2369,1515,2141,5442,1882,7910,655,9307,4565,9520
,9344,5186,3592,4953,8006,6809,8392,4041,2777,8894
,5439,5489,3162,6052,1529,7037,1567,4189,9559,8115
,5328,4422,6813,4997,1246,9474,5741,8461,2614,2589
,7238,3942,8752,8933,6431,4189,7036,9504,953,4423
,7430,7533,1731,9992,9517,7396,6264,6524,2031,6019
,4402,2591,4887,6781,6632,4859,3713,5921,4856,5744
,6880,1450,5675,3572,5038,4549,6167,5234,3139,3480
,2169,1342,4976,9992,9061,3881,211,8226,5044,6375
,3904,6123,6922,6533,8550,9327,8386,1412,8604,7596
,791,5069,7517,3702,6439,8722,7264,4844,4363,3401
,377,6550,8603,5108,4478,9084,8991,2471,9305,6353
,4432,6902,6249,7313,8684,5253,379,9875,8639,4969
,4982,7309,5107,1751,8585,7157,6092,9705,4492,2632
,2581,4002,2813,6527,6816,6035,4998,7622,3083,1073
,863,9590,990,8418,8126,2402,1248,4063,4438,6235
,3953,5844,1909,7875,9366,1101,4148,9629,1197,6832
,5785,725,2383,2349,4510,1224,3371,4435,5598,8419
,2901,5000,8947,5750,1282,1236,8600,4203,6179,8276
,4787,6220,891,4348,8448,2106,5132,8432,8268,8929
,8316,417,205,1936,5332,3756,9529,8452,4831,621
,5342,4286,6,9563,7619,2644,1869,5667,6733,5527
,5037,3204,5491,7644,6014,794,3662,2813,3967,9057
,5007,2871,4011,772,6816,9078,2991,3534,1933,6024
,7759,4905,3291,8037,5961,77,941,8086,9313,2024
,1587,9188,9387,4160,612,8318,5886,5494,6612,2810
,7433,8287,8429,9266,4846,8210,4679,4961,6921,6996
,5785,1753,8716,7599,8508,2483,2329,1852,2978,9887
,178,620,2225,7998,789,6456,4211,6055,7069,8761
,6361,4909,7093,1436,2595,5927,7382,3043,2857,2400
,8686,9454,5147,3451,4266,9017,56,438,671,203
,7790,5861,1026,1767,7708,4769,807,5405,352,8668
,6126,907,1973,1923,4509,3816,1569,666,8182,5583
,412,4207,9848,6222,4082,8932,970,9470,6996,4714
,2552,440,9440,3820,8420,5778,7101,2315,1004,6320
,3097,3969,9619,2246,2509,6663,1244,740,9412,1297
,3809,6143,6407,3194,1970,2612,6653,6006,5392,9272
,8392,8123,9532,7878,1992,1576,8921,2966,9465,3446
,2941,4512,6508,9770,4110,3088,7031,1943,8861,7519
,187,5632,826,5036,9905,2173,6613,3935,6921,2487
,4093,8734,3307,3477,3176,7827,9506,6942,9093,3642
,3862,977,8182,5295,4648,3884,6162,3748,4603,576
,8921,9467,7957,1482,5794,2573,9968,3958,5341,5505
,8949,6187,3637,8169,802,3590,5044,5601,6047,7730
,5498,8119,9356,7719,8288,3980,1580,4123,2338,4537
,4286,5372,2988,1896,6784,6661,5276,9069,5658,1360
,9716,2634,6800,4919,585,7890,9940,1274,6700,6513
,5676,1753,4698,6710,5008,6485,4822,5881,1366,8301
,9200,5768,5144,9146,2624,118,731,8982,5834,4834
,6038,7193,1301,635,4536,6495,1501,8209,9783,9341
,9706,5874,2456,6824,3256,9728,9881,87,9347,6309
,8068,4229,3310,7753,6239,4710,9391,9446,3859,6256
,4032,182,170,4268,1657,4819,6220,8728,2947,9439
,9395,604,5624,8997,449,754,7734,7484,3038,1338
,3425,578,5750,9720,1231,806,6633,4875,4851,5193
,233,6296,6432,5424,7118,5399,2348,501,5915,9431
,1485,1892,7837,7875,6018,1195,3718,1357,4695,292
,3542,3051,8620,4000,8473,2587,9526,5237,5389,2455
,568,2670,3913,6914,9595,875,5943,3397,4936,2991
,7682,6415,3677,5881,4172,3967,2449,7781,6326,6444
,702,8463,454,8037,6492,1887,300,641,4757,1361
,1569,262,8104,7191,8963,5924,86,6845,5708,1075
,983,7603,5584,7493,6087,1717,7463,1692,6480,4066
,2334,3829,2317,2310,2837,9110,8605,9552,5293,1696
,3487,9489,4236,1109,9022,4068,9446,1137,4465,3648
,5475,1246,2052,9649,3684,478,5277,9714,6772,3863
,9674,5363,5806,1324,6102,2147,9754,9082,6521,2308
,7515,3564,2277,9934,2453,7807,4883,8614,9423,367
,9297,1596,4307,6722,9706,4442,6044,3182,7809,185
,1161,3292,3593,6985,804,6741,8620,8284,267,766
,1803,5466,1029,4058,7691,3008,5281,3170,7250,6140
,2957,1425,1142,1001,1267,316,5507,7294,6727,3418
,246,3441,9694,2793,9800,4244,1390,7893,6433,1035
,3439,6973,6013,4339,9897,989,6292,9024,1783,11
,7687,1960,4110,2124,6564,2176,5416,4840,1017,3517
,9796,8998,9150,9795,1432,5176,9856,2453,1627,2593
,6104,713,8332,517,714,4241,8181,2171,4640,8294
,1023,1140,7754,1386,6946,277,2125,5434,5818,3106
,7799,8424,9312,7735,1083,9560,5438,3255,5326,6924
,5577,8652,4196,7629,4008,4209,7468,482,9945,5416
,9300,1132,2061,9372,9016,9730,5526,3696,4388,1087
,1535,7928,7416,7328,9338,7441,2610,3048,775,9843
,7770,2969,7303,3884,7271,2097,9531,863,7838,8377
,9250,8536,6833,7848,3962,7519,3034,2305,3914,193
,9915,9448,1630,2117,1429,5541,3937,5929,290,572
,6505,7751,8752,5902,868,6100,1891,4429,3963,3291
,3386,3236,159,9345,3802,8757,5786,8392,1371,4424
,6171,7582,5268,828,5164,8487,1402,8376,7172,1011
,689,2444,1690,9793,9834,1035,333,3114,4619,4936
,6366,4306,5675,374,6734,5654,6770,4170,6598,4805
,5589,1399,6361,3674,7011,5541,1201,9849,8898,1145
,3104,500,367,8976,5393,8780,2579,3680,9762,2738
,2017,3933,5802,6719,6267,5102,3039,5276,2299,4400
,5459,9570,7251,8542,8544,6282,1706,3899,8802,9017
,5477,9160,5796,2208,5887,482,6677,7526,8549,9149
,3216,2784,648,1730,1335,3344,6724,2733,3134,6023
,6951,9760,1432,5500,7919,1166,6786,3219,5914,6215
,7032,8802,2704,7734,9311,3948,3812,7273,4604,8842
,9306,2756,4759,1065,7075,8642,2026,6993,8610,8579
,1084,5709,7290,561,3579,5406,9156,4583,5146,2297
,6200,2800,4951,2017,2140,2180,7712,3532,704,9662
,8237,5542,6414,9812,8453,5393,7859,4980,6938,478
,3487,7953,951,2144,9877,7116,962,2102,2524,4107
,7689,1329,9124,3968,1622,1475,5348,7810,5060,8773
,3126,7962,6638,438,1434,5631,8361,3581,9564,1056
,5135,6612,2917,6167,6796,3143,1274,9739,2645,8401
,9587,5049,8476,8127,1250,32,6109,9989,3890,9937
,5418,7483,7641,2486,8869,6342,5929,5524,8544,3442
,8752,7184,5677,8207,8462,8534,2683,6518,8046,8741
,7690,7113,1905,2722,1571,503,9140,1302,7473,370
,9329,3873,2849,7474,810,3544,3993,6067,1462,4805
,3066,2787,1985,3675,7628,8077,1686,367,2674,80
,6753,4435,5160,1053,1043,2438,1035,6271,9357,8093
,4776,5431,3228,4930,1416,6560,9197,1451,1073,2425
,9595,8785,5988,9430,5827,843,50,9033,4151,6977
,832,1643,3960,7133,4116,3033,8562,9510,932,3242
,8463,716,7083,7984,7149,8421,5180,2553,9363,6519
,9171,8229,1890,2778,1374,1183,6838,9000,2006,3887
,7418,3678,1218,9019,6227,7148,3621,5864,6024,9251
,5323,9229,3021,9484,3454,843,2654,9659,8204,3265
,7871,9060,7349,6291,9911,2095,3286,5858,1583,8458
,2559,5454,3052,5781,7896,20,117,4793,2738,2360
,4994,6973,8271,2045,9593,4710,2953,6820,1307,3956
,4551,6509,1285,9386,4671,9424,5219,2049,5786,1268
,6623,9529,769,6544,2614,8600,4928,2459,2194,379
,530,5333,7031,7988,3838,9502,4742,6706,4641,8727
,4668,6625,8284,97,6165,7811,198,440,9377,7953
,2937,5225,8520,2527,5701,9970,7666,7446,6376,4149
,9019,4220,6058,7596,3701,7609,6088,9413,5029,5784
,7582,9376,4302,2978,3464,1842,9076,4646,2993,2152
,3948,5120,8801,5542,3839,7764,6417,8546,9772,7633
,6304,2902,7155,6628,8386,1960,6564,1149,9083,9589
,7019,2257,838,1581,1770,8327,4154,9556,6578,204
,2119,7372,494,8861,7441,32,9140,5552,1979,5083
,493,4473,8773,6530,3165,7915,6575,1240,7183,3919
,6884,7845,7272,6438,3472,8153,8636,7985,4417,1051
,5236,4798,6638,8914,577,4489,2920,6506,986,6204
,1450,2393,1393,3278,7846,2846,3611,8394,9689,8246
,7122,1233,3556,1991,2353,8639,4545,1905,6460,7265
,8316,4141,1611,8740,5612,9588,5761,7317,9299,2778
,5941,32,3891,3291,4033,9361,7585,9663,5055,8377
,6790,5792,7941,8403,3159,9841,8822,9172,3121,5651
,6807,1479,9912,6638,2265,2343,8105,2208,7607,2657
,642,6659,566,7348,8367,587,9977,8034,2054,4793
,4061,8177,6940,6689,1205,742,9757,9207,3243,8350
,8262,2201,1238,5940,3268,6354,3762,5919,3178,9587
,7679,5822,1011,5963,1424,8467,3939,7094,786,4611
,5314,6048,7190,8107,9202,3752,8475,3561,7412,7902
,2178,6486,9030,4369,1316,5960,2448,1101,2664,9781
,9894,4536,7538,2124,4468,8502,5077,3698,9669,5626
,8023,4402,1428,1241,1004,8479,2638,9791,1313,2174
,187,3738,2190,3892,4488,4967,8603,6851,1512,8693
,5533,4240,7316,9869,8747,6876,5076,2088,8088,3356
,4621,8994,3252,2721,4458,8185,2068,9605,6311,7620
,1283,1893,2144,4528,9841,880,3699,6808,4663,3926
,4524,6942,8931,9611,4505,8397,2868,5390,6897,4534
,7019,7753,7856,11,8033,4881,8468,4691,6942,1797
,9283,51,9947,8030,7345,8083,1694,7764,5724,2704
,1057,2498,5547,3660,9422,6204,526,2934,1465,2978
,3995,3652,8434,7201,8437,1489,3930,6193,7519,8574
,2191,5370,617,9897,8867,5898,9854,2218,4310,4855
,9627,5468,9348,7879,8642,6659,3568,4333,4439,6292
,6099,4954,430,7256,8894,2013,5427,6241,2506,1971
,5674,7644,4375,634,9375,9970,9606,810,3732,4743
,4254,2466,4470,7911,1098,5382,7872,3753,7931,4311
,5308,1282,8334,6630,267,3156,4961,2501,7889,7080
,5322,7527,6995,9714,57,7902,4620,3082,3727,8078
,3042,3472,8087,909,9316,2848,7871,319,7300,2754
,9074,6448,2195,719,9731,3318,7567,9167,3200,8978
,4884,6817,3941,8173,5546,2598,5801,7488,5415,2046
,2791,3014,1848,6217,2371,498,3226,3090,1228,8002
,989,1474,3559,1060,4162,7414,1853,330,6393,3099
,171,1756,5475,8266,9926,9221,5388,4107,8168,9703
,821,9675,8362,931,4210,791,3669,1544,5264,1449
,2732,3744,3000,7725,7949,8456,273,4180,6263,2980
,807,2767,2437,1148,8725,4239,4839,5985,584,2054
,3721,4859,9902,8781,2001,7141,4191,5005,8544,4360
,4491,739,3945,2858,7397,9321,8806,8951,9589,3829
,4523,6579,4872,5982,6562,7467,3696,7549,243,3777
,5196,4252,9023,3271,1719,2176,5272,6958,5855,6674
,3559,9258,9972,3771,6430,656,8241,4073,2693,2857
,1174,9174,8195,6441,2650,557,9106,1024,9451,1007
,7701,7910,3288,8512,636,5249,5336,2674,9737,5693
,3264,3608,5275,6552,767,3358,1750,2451,9595,9795
,6172,485,4088,3027,8843,7877,8204,4304,6634,2132
,5052,7427,8773,3695,8921,2648,5122,1106,9814,3086
,6958,8658,480,3621,255,6553,5939,2313,1467,3555
,5522,4299,5806,2150,7396,8201,8028,6201,5597,5036
,5707,1104,9562,9620,5025,6445,6158,4472,9045,1155
,4217,6225,8498,1168,1565,4526,5062,9574,4552,3449
,7143,9280,85,5396,8158,8162,160,7508,7313,6724
,8891,566,2888,8252,2042,400,8017,1473,9061,1797
,8965,5709,7607,4903,5919,8533,582,4134,6257,5928
,5667,9577,341,4939,7345,901,9789,8835,1441,3761
,8261,4759,2148,8705,4740,3889,1557,2579,9312,4092
,1694,2435,1447,5080,9046,1934,784,6067,1594,258
,405,5926,8346,3510,2624,5845,1366,8625,7262,4481
,303,9773,2434,5619,9430,7267,7824,8328,7168,8970
,472,9613,8118,4198,3053,9580,7597,129,4655,9081
,8664,710,4067,9882,1654,8061,5553,7310,6209,6380
,7140,5413,5809,8355,1394,4617,4802,4064,8704,1880
,7937,2384,3062,3350,2396,4899,344,9521,2322,2301
,9096,2890,5852,3304,3805,8109,4651,6042,692,4647
,5937,1980,5986,1943,7019,2320,6705,7064,2324,6908
,3941,4858,2928,5635,8641,615,8591,2350,9884,5218
,2284,1263,5667,2804,7223,5851,6183,917,6401,265
,9603,3167,4614,3236,361,4384,2998,4482,9928,8273
,6059,3611,100,7575,1202,1534,8774,6720,764,4365
,8236,6981,6545,9827,5933,4136,6839,6165,7762,8621
,5965,3544,3849,8185,6300,7962,6828,3048,2807,7651
,2626,3557,70,1988,3741,344,1823,2896,5023,6977
,2979,8755,1960,5123,4168,805,1454,2200,8762,2057
,5105,1532,2407,8690,4992,5011,5059,3969,1951,8247
,5510,4642,6362,8228,8420,9849,1427,3476,3852,2531
,8950,6700,9298,3332,7621,9958,4216,7011,3795,2307
,7054,1340,4775,9964,4789,8517,4594,8959,4954,9071
,2290,295,168,8265,2698,7599,5171,5007,9721,7284
,6352,3252,2118,1201,3784,5911,1780,1797,5750,1256
,4517,9770,5778,1827,3335,4227,2174,5837,4218,5341
,46,1079,4410,9503,5844,1335,3197,6982,4385,5275
,5186,2082,8386,7872,6089,5792,498,4302,1000,952
,7833,6353,5183,9901,8997,1329,7346,4636,3623,3461
,5426,9470,4399,7807,4871,6184,1601,6662,9420,1690
,125,8466,4384,8180,9017,9204,2425,5787,3504,6319
,1844,7738,9529,5115,7355,8014,774,7661,3371,1502
,8200,4203,9781,6657,2074,7066,238,651,6500,7061
,2932,7035,6453,2391,3877,5892,7306,60,2690,6496
,6865,9774,874,2465,9898,353,2596,9419,5170,8634
,7972,5139,4967,876,8846,2217,7134,6670,7072,3217
,9605,5343,5293,8330,7432,4864,228,5531,2316,3252
,8446,3233,4641,2480,4652,5446,8005,4881,2468,9431
,6248,2060,7713,5858,2986,6291,4183,1460,3643,4430
,1935,4192,9979,4321,8067,887,7124,3697,9999,7408
,3110,1593,1254,1311,897,2248,9741,6994,2911,1512
,8535,3361,8070,5752,9156,3972,1320,3261,7354,9700
,5661,8160,1391,3891,6683,6807,2816,19,9593,6702
,9753,1837,8750,7896,2679,6041,9694,6892,2704,7422
,3678,3057,2357,6523,4700,7523,8862,9793,9032,4599
,9923,2249,7252,5671,2002,2626,8780,5613,1103,1037
,8899,1692,6053,9129,8298,4972,4282,2737,5095,4224
,103,7042,9370,2328,5499,4227,199,5185,3396,3634
,5183,3117,3451,4419,2479,4777,329,709,5332,3553
,4490,9256,9107,6479,5461,9598,818,5635,7625,6710
,1163,2056,8501,6166,9049,2140,9521,1788,8631,6551
,9318,5808,8837,1628,9500,1524,5403,3289,2937,8452
,5403,3439,4539,9987,4278,8876,4539,3555,5372,2697
,4272,3274,1959,8201,4459,5107,1777,5303,5988,4517
,4057,9433,3192,6627,9056,2944,9634,8875,88,9020
,6387,6169,8054,8083,2814,8542,8475,6696,9849,1314
,1022,8970,5784,7741,1547,472,4541,4177,6617,4631
,6461,7727,540,1643,1581,6404,4902,9877,5416,1786
,595,9784,7242,4171,2348,298,876,235,5760,7750
,7956,3186,6830,7267,3725,5423,3989,6681,5309,3689
,2631,2936,2503,6730,2143,995,1046,5450,5439,5241
,8406,5568,988,3391,2064,2771,7348,2897,288,377
,196,9852,5420,9485,1860,401,9656,1633,3348,4640
,3326,3956,8882,3031,5676,6840,2928,5300,8150,4079
,9727,1847,169,5534,5328,7655,7416,2282,2116,8691
,2613,4282,5846,814,8805,522,5173,1183,5141,1683
,3686,2163,5154,5289,4432,7728,7543,3368,6958,2371
,9455,2603,6831,2509,2266,6996,7679,389,9860,3016
,5714,493,9412,7261,6771,8448,4672,6611,5833,2427
,1741,886,9065,7060,7355,8002,8344,9839,9666,1626
,8294,21,1525,1335,5812,38,6260,5268,2102,9404
,5959,5286,7206,1116,2250,4628,7035,567,9585,8064
,2901,6945,1019,4555,3548,7146,6492,2407,9681,2177
,3609,6929,1001,6062,922,586,5733,7248,3714,5661
,2660,2514,2275,9404,5653,3373,2687,1694,700,4983
,106,5192,5441,7549,4539,8001,1197,233,9128,8816
,7504,7555,932,4587,9139,8306,4208,671,5657,6950
,6189,3488,3417,7530,5371,5682,118,75,2288,3772
,1828,9509,2797,8310,2514,7052,3861,6537,6076,4132
,1824,7542,877,8785,3199,9914,6772,4567,7945,1900
,4645,1957,5249,4062,8433,2265,1809,4434,9664,4036
,2613,6175,4482,1957,4222,7729,3183,8267,549,5477
,2246,6657,1145,8898,8861,8679,1973,8221,7963,2656
,8697,4586,1761,5082,2456,2695,1773,4532,8152,5972
,3352,8067,5226,4216,2724,141,941,3761,6511,4006
,6166,131,3770,5619,3651,3195,520,51,8816,4822
,6773,387,3025,9043,6067,9138,9373,4700,7497,2144
,962,607,247,4982,1689,3206,617,1871,9519,6720
,1560,7080,2273,5814,4711,8832,5906,747,4915,5712
,5290,5030,7265,5571,7492,5582,6625,6936,7561,5388
,9670,2912,6802,8653,9409,7592,3564,8458,2224,4962
,6517,6918,7393,304,433,7837,9131,4109,4472,1865
,1110,8475,2958,4155,3501,6021,8662,4516,2498,1289
,8584,74,2352,4649,2235,422,9902,8711,2415,5285
,1606,7225,8497,4667,3072,6490,2209,1513,1092,9260
,5911,6863,8167,1153,3382,7512,9545,9550,3095,6158
,2749,5009,4004,4068,9607,5168,3822,6227,788,1151
,9803,8999,2827,6473,2024,279,7660,8449,9163,2154
,4657,2100,6787,6053,5148,6557,8125,412,9459,3970
,7355,820,6439,910,5383,2684,5498,2282,8126,6380
,1130,7724,7292,4913,9948,518,3658,4068,219,8995
,2858,5073,3889,440,3661,9748,1116,7501,8749,8167
,7304,7093,8004,8814,2633,1804,4285,1234,4086,3802
,1711,1194,9989,1242,6442,8339,7033,7173,9962,6346
,9812,939,4857,5582,2849,2093,3096,8259,5133,6798
,6817,6092,7144,6733,1604,453,390,503,2270,5030
,9435,7541,1137,981,6429,4519,8819,4590,8144,4250
,7500,7425,5501,7095,6721,8994,5601,4872,1655,1899
,6262,7259,3892,9497,3042,701,4719,6050,8776,9819
,903,9386,5606,1312,2968,6053,9513,367,5982,8978
,7344,9562,2833,7618,6348,275,13,621,6208,6589
,5899,982,3565,1696,1535,3696,9059,6810,3911,5917
,6851,2566,1745,9613,6663,2928,3767,6724,8302,1598
,9496,6816,8694,922,2524,7237,1417,3292,6296,5776
,8730,5056,2392,5819,6105,2924,1310,4001,9258,2873
,5742,366,3679,1555,6359,1025,6667,200,95,3305
,1859,1025,922,3415,6257,6141,3135,6594,9770,8957
,7132,9772,7232,8086,7697,6723,2945,3753,4778,5724
,7701,6702,6774,9711,8322,9599,6308,8932,9682,941
,8516,6110,9246,1460,1824,4090,4097,3033,1229,6004
,468,84,4084,7920,5775,3491,8374,4006,3146,6997
,3503,4178,8452,6110,3570,4262,9842,9511,3154,8649
,9769,2964,5592,5450,9527,5716,3763,4152,6275,9410
,3368,5776,2576,9484,8714,5534,8422,9085,988,7981
,5771,5469,9047,4676,5573,8909,2694,4334,7302,4104
,8459,5488,992,4081,7884,1638,1763,6606,8302,8913
,6853,3084,6116,6225,5154,9971,2585,7925,9236,2679
,2100,8960,9884,1979,2972,2529,3125,2911,706,239
,9765,6189,3786,4761,7412,2105,1957,4987,5017,6941
,7004,3687,9896,1868,6034,7663,7266,4357,7259,407
,2279,2086,8274,7257,4545,9342,6841,3051,5172,5930
,4170,2288,6292,8579,698,1780,3093,4848,4372,5809
,8352,9534,1430,3786,9464,3574,9685,402,7975,5455
,4298,8292,1613,5119,6071,3183,8819,369,2216,1554
,5777,5777,9648,795,5947,4087,756,1858,2096,123
,1691,4417,829,7198,3145,4521,9620,6015,3631,4755
,6342,6076,5266,6892,1301,9589,2054,7050,1767,7873
,661,3351,9001,265,3703,6072,7792,5525,5524,308
,8485,5743,478,1122,1513,2746,3709,1207,4427,7004
,4435,1034,1430,9034,1725,1520,5406,3310,2785,9172
,2451,4667,3736,3753,8907,7207,2897,8432,889,5705
,6564,2442,6321,9519,7295,6239,9464,8989,4686,9154
,7948,4352,8659,9552,2302,7141,5237,7488,7990,4094
,4827,9861,9935,3563,3005,8074,9558,4415,3792,8186
,4302,7441,5439,3572,9668,9264,8704,78,3746,8741
,7639,3676,4244,5873,2867,622,8020,3209,7364,109
,3115,9754,4743,9430,3281,7374,31,1626,5015,9701
,2952,5648,7091,3545,3710,9012,2588,2791,1267,2954
,3421,4813,4128,86,7379,9378,3619,4555,7647,51
,9670,4695,4844,8101,9096,8190,1551,8911,6376,9721
,9343,879,6939,1130,8321,6828,2941,4073,9142,7912
,1548,5177,7552,19,5718,3695,1415,2681,7480,1664
,245,479,3717,6560,7240,6949,4446,6454,3808,988
,3602,7672,6603,5760,2314,4945,7053,105,4694,4069
,3395,2440,6109,7061,5201,7170,3971,9816,414,3594
,1011,2262,4877,7307,1067,1014,4365,4110,7358,4536
,9114,6417,3271,792,857,2158,5642,7404,2350,6186
,531,4310,9407,4187,1512,8918,5430,9080,448,3762
,8439,9929,775,6661,605,3346,3282,3372,281,7397
,4393,2747,6532,8011,6947,4392,6168,7884,3483,8821
,3274,7886,2015,111,1243,966,4320,1061,7302,8561
,6714,846,9552,9499,3335,5174,6492,1408,1926,8944
,9051,4621,2114,1400,5124,8582,6192,3787,6599,751
,2401,9508,8889,8015,709,6784,2963,589,1095,3802
,9880,8425,4329,6379,7817,116,5252,8113,1599,4308
,8560,3045,4738,3596,7084,807,3953,942,2569,4287
,6212,8572,8958,9778,8256,9387,8175,9641,8632,869
,8400,7454,2226,1484,4857,5674,7294,9594,3090,5792
,4991,4856,4748,986,1403,2134,5865,1281,2082,7904
,7639,1205,9070,9159,9717,9943,438,4814,5975,3994
,2310,9618,2797,2328,3403,552,9860,4044,2048,5743
,3411,8521,5729,5865,2052,8079,3111,8047,5019,3135
,8572,2281,2965,9855,9235,324,1240,315,4497,7109
,5672,5156,8062,4649,849,8739,2472,8441,900,6801
,6140,6378,2777,6614,2875,149,2033,9638,3922,9149
,1109,6680,2487,6885,111,5547,769,9881,90,1207
,9496,9084,8829,8440,9949,3774,9119,6997,8498,7963
,9541,9258,3632,9310,7751,383,5493,519,6256,975
,7900,3251,698,2230,2888,4528,637,3596,7736,5641
,2829,2932,4498,3552,7008,9158,2033,4806,4168,7416
,541,1931,7344,6727,8589,2351,4895,142,2644,9787
,6281,7402,9106,8166,348,96,8839,8024,6108,9314
,4197,5417,6020,5802,8564,3325,1771,2622,8378,5557
,2559,309,7665,3157,5873,4521,5071,3315,772,6201
,3391,768,3672,4232,1605,1706,6621,593,9401,184
,8085,8012,4216,7022,6224,129,758,1216,4681,4146
,3045,3840,855,5987,8932,4455,6689,7952,7141,14
,1945,8874,6797,6272,9992,6778,9457,1684,6081,4031
,3638,3821,8130,5004,1854,8268,6,6226,142,37
,7301,9041,98,7467,5619,4763,3404,8635,1355,2332
,8862,261,4976,8474,1925,9112,6802,351,6726,5913
,5289,723,612,1748,7807,5601,1174,6968,3926,4406
,5779,2600,1192,2620,3598,4250,3412,6950,145,8511
,1434,2975,4297,1867,6427,5312,7836,2102,5666,264
,7474,2205,808,982,9385,6776,8678,5118,6239,934
,4548,4981,6730,1719,7918,196,7609,2003,797,2860
,8216,6895,8487,5193,7507,2645,2861,9701,3593,8053
,8145,1831,5763,8372,9201,5121,9020,1720,2306,8865
,1111,7978,8435,8263,2059,205,9041,7081,6193,8538
,4338,2805,6680,6601,4079,4298,2556,409,840,1955
,8259,9778,5802,362,5656,2228,7029,3451,8579,9390
,252,2155,9852,5914,2148,4565,827,872,6124,8588
,3411,1667,595,7099,4599,439,9770,5602,3506,2969
,6928,2384,896,89,200,1172,1216,1583,856,6286
,7125,2600,4079,302,6526,2553,2250,4200,2098,6531
,728,28,3328,9203,6133,6053,1037,1223,7124,4419
,4419,8140,7685,1303,567,1799,2902,9572,6505,4252
,7245,3938,3720,4162,5351,8617,5194,5708,5304,7480
,4935,9995,4417,6716,5,8958,7512,9981,5056,1766
,7703,6060,9358,3733,9676,9022,6334,7721,5469,874
,5585,8046,2756,6719,7427,6888,5628,2413,9920,3192
,7872,4718,8398,4077,8753,3962,7504,8745,1297,9194
,5717,4879,3070,5839,2386,7561,9462,5856,7260,666
,9464,392,2519,779,3954,4943,7308,3592,6475,7002
,4765,2817,6516,6225,1552,1590,5298,7080,9889,6375
,4048,4005,2084,3376,4787,9067,7564,7436,3606,2115
,2407,3448,6450,3438,1370,261,7400,8920,2427,7085
,9453,7698,3792,2395,7800,2315,3457,5345,5615,1382
,1221,9663,2330,4727,3219,69,4416,1058,8956,1171
,8670,8114,837,8879,7989,5324,6200,4307,9658,8965
,1844,180,6124,9811,1064,9740,8286,3300,3178,8155
,1267,2180,5564,6420,2704,1672,8185,7770,3521,7123
,623,6579,1217,4163,1614,9772,5644,1363,1071,728
,7289,5388,4623,5689,8052,8656,643,2663,4535,9493
,9777,2832,3816,4788,6979,4459,1732,5153,6043,9291
,3663,2575,6629,1471,7810,577,3799,8938,978,6868
,47,7338,6855,8504,9827,6426,6799,9544,6591,8978
,3112,1205,2315,2190,4824,4517,9530,1592,5978,5482
,5858,7446,6405,2727,1036,3661,5011,7666,6456,9191
,5551,7150,7188,1947,4921,8624,6518,5202,3927,7789
,2972,6496,577,8750,9856,9041,5854,6680,7279,5631
,2004,2971,6690,5047,3310,2892,7906,960,9382,5745
,8646,3342,929,7522,6559,2370,8047,6061,3757,4831
,999,8701,3847,3030,3494,2440,1461,6197,8469,6590
,4288,4390,6372,7934,7603,4906,5940,8381,1303,1182
,7485,5125,9433,4205,8671,3298,2222,6418,2797,1128
,609,8124,9578,7595,3280,6393,8426,2588,6194,6470
,4231,9559,4619,5681,5644,682,7659,9836,5858,4507
,5287,2139,5885,6118,7878,4592,343,9788,8238,1904
,5733,4136,6135,7894,1225,9782,5332,4397,1933,9505
,3117,2674,4702,899,2336,7316,6384,1528,5920,2649
,4625,6583,3922,1643,1142,9038,3045,7316,7504,2307
,8671,6641,3418,5399,9398,6953,7504,575,4066,4854
,581,3505,1293,7620,1445,5924,1500,7107,5154,785
,1450,6158,3806,9921,1271,7507,9820,4197,3995,5188
,1719,6165,7583,8441,2414,5228,9460,8115,9976,5286
,3545,5578,929,4901,9783,4122,6023,9945,6175,2868
,8516,8766,3310,3175,4961,9834,1396,7543,8480,1906
,9791,1022,4550,6677,9036,5116,9283,3937,5383,4191
,205,9229,7831,4380,9542,4003,7651,4991,9997,8275
,423,2411,3033,5781,563,6513,9654,1634,8359,9564
,3686,2480,9496,7630,7559,9154,7093,4479,588,1838
,6232,7994,9753,7715,987,9073,2982,1126,3959,3040
,4931,6227,8305,3547,5267,2145,2272,8984,9447,634
,6223,1383,2000,6230,2172,7824,2309,8909,5817,4342
,2892,9243,1067,2336,182,6057,7074,7470,7811,6581
,7769,1082,2387,9113,3886,4091,1781,8170,7499,3401
,5903,2146,9050,811,9984,3468,6882,4417,362,1254
,9270,2519,2756,6465,8951,31,3055,9567,157,7383
,591,681,8144,1929,3928,2246,1227,1854,9137,4168
,5306,2577,583,1483,903,5662,4201,4508,2688,221
,3280,1502,1514,6821,6745,3817,8947,3890,9934,3558
,4296,6625,7885,3739,4147,8394,1115,937,4390,4648
,3898,451,4757,9323,5052,3957,5844,3748,1214,9662
,8653,8050,2627,4965,6613,5061,1419,1610,118,6727
,2382,3343,3555,3008,6257,6067,4839,3289,5512,500
,7439,287,2627,7333,4913,6453,870,4880,7937,2881
,7584,9242,3839,714,9965,6956,8627,5052,3342,158
,1525,1353,1961,4233,1997,4344,2267,7977,9284,9427
,8681,6248,4436,6582,1885,5125,4837,6778,9601,9566
,1243,874,9875,3561,7308,1028,6856,2788,1621,4605
,9076,9773,2231,581,235,1543,3682,8446,2479,9782
,6544,9620,2184,3491,9442,1347,8235,4141,3591,3112
,2807,3327,9824,5539,4649,2931,8124,1803,4862,7772
,9657,1534,5183,767,1300,7223,8764,583,2675,3128
,3455,1795,5681,6680,7585,7544,6522,2394,8240,4692
,239,8266,2051,1475,7744,4689,8468,7664,5349,5852
,5547,7222,6796,3651,8227,3453,7792,4093,9113,6666
,3038,6200,1758,4328,5759,3421,6444,3719,9737,7534
,8463,7091,3842,5054,8895,9322,9065,6136,7895,8074
,8044,5988,472,6449,7102,8769,4769,8143,772,4002
,2842,5106,8833,5476,3950,7693,5839,2654,326,7327
,3149,4582,5465,1650,3464,6287,4901,2182,7849,7694
,9493,4473,5274,5022,1201,767,4637,4699,1372,5151
,9301,9763,1516,1214,4122,8768,6594,2204,4983,7193
,792,3683,822,1348,5809,8683,8166,4779,1633,5366
,8160,7173,9823,7173,6099,5768,9296,5488,3463,9255
,4598,4788,2441,4188,6696,303,2969,3888,6252,8171
,2255,9849,9406,8097,6818,5647,6059,8502,7011,3342
,652,4188,4058,2388,5449,6487,9584,1038,6318,5924
,7644,249,1011,7366,9256,91,9945,7685,9435,8650
,9486,5909,6717,3436,7728,5883,5199,5290,2775,1419
,9061,4788,3521,3959,9607,1150,2933,2727,4789,3644
,3832,7388,1241,5494,7172,3199,8808,283,2825,8673
,7583,865,2860,5730,7432,765,7323,2353,27,8089
,2521,7746,3380,1930,1803,9992,8870,1272,8837,6206
,778,6399,3398,5192,8316,2801,9644,2599,159,7578
,6899,8580,1476,8346,2935,7945,3461,4649,9752,2819
,5366,1858,1860,7797,9029,7580,7060,7601,5909,566
,9724,7236,6614,2116,6580,4649,2934,9984,4990,5878
,2372,4787,3730,2718,5176,8906,6275,2868,3868,7901
,6578,2595,5278,4408,7353,1883,5071,4550,854,2096
,4786,6845,2157,6130,1358,3606,4941,1071,9155,4855
,9772,3349,4510,4723,4879,6399,2746,358,9441,811
,7715,3333,9364,6992,3825,3553,5564,317,569,5655
,4749,8791,9564,7921,2697,3200,4073,3683,42,9771
,1043,5227,552,5325,5634,198,1909,4936,8248,512
,8996,2087,4064,3758,9671,1323,5069,7104,3055,3412
,4585,3704,306,2998,4305,1608,7908,8759,3822,5159
,3447,6061,2660,8911,3893,2118,4807,4026,6384,3642
,5744,7183,1503,7007,1979,1988,9064,901,3074,2874
,6387,1480,6182,1513,9088,30,3072,5716,4352,3120
,9667,846,6717,5255,8069,3721,6358,4039,1092,9018
,9865,7828,9298,8183,3524,5885,520,836,9103,1038
,1902,8677,2125,4834,4421,1892,2658,5200,9928,8060
,8591,6594,671,3558,1415,2663,1331,7469,4509,1403
,3552,7987,3914,2808,2971,1323,1622,9033,8752,3114
,1351,7046,5614,2323,6830,3786,8366,7654,2578,3819
,8934,6450,7188,9494,5896,6105,9105,3600,6510,7967
,4908,4521,1248,3745,95,3894,826,4417,2359,6764
,5736,1634,7371,4239,8275,1627,7064,8648,7079,1612
,411,1200,4154,8701,6705,2133,4405,1302,1347,3377
,7668,3028,4119,3706,3244,9106,9970,6399,6926,5278
,2298,9390,535,9210,8726,7928,3946,4399,9391,9734
,9623,6579,7718,2656,9650,2624,3706,4823,5260,1960
,9705,7306,8867,465,8703,9271,8601,6881,5101,5634
,5333,1717,8000,7223,2211,8653,6978,3426,6690,8453
,373,7355,5060,5366,6064,3499,9484,6032,4752,7877
,7523,892,5741,701,4171,8090,5223,1527,6383,9884
,7051,6913,110,1547,6030,576,9828,2777,3690,6046
,568,1602,6572,1825,2452,787,7009,9042,7719,6737
,6405,1607,258,910,1018,8874,7641,3715,241,788
,5651,926,7383,5548,5319,2580,2948,9761,2447,4393
,423,1100,9645,1657,4551,3455,863,5653,2117,4597
,8417,2552,5229,6327,2526,4827,7099,7137,3340,5154
,321,7365,5469,2820,7658,6851,5022,2630,5319,5092
,9130,6314,8741,3900,7982,6432,872,2558,9354,2778
,2950,5476,5642,1290,7786,2347,3391,5456,5545,803
,5330,218,2024,1572,4899,8378,9439,6135,3283,9509
,9703,6880,8941,1354,206,9760,9642,3738,2098,9447
,6988,4973,1071,6993,3454,762,639,9981,1914,5609
,7919,5184,7674,6719,1913,3721,3003,414,4290,8713
,4163,1028,2664,5439,943,2323,6380,3991,8686,1388
,4791,4434,2828,5052,8042,4460,5918,8782,349,9542
,7159,8098,5784,5593,4435,2472,6551,4125,8844,1739
,3772,9897,1725,5001,764,1079,4196,2035,8826,1906
,9179,7196,5514,7832,5935,5826,5425,3189,7094,3162
,3480,1341,8187,5736,702,7343,9675,5287,2500,3095
,1484,5166,9447,4999,32,9240,566,4115,7765,3302
,9107,8818,5182,8972,829,9953,5374,109,4783,8492
,1047,1714,6593,5691,4062,1335,4236,5745,7457,2978
,6322,945,9986,3508,2879,9332,3147,1558,8632,4858
,711,8937,8784,39,758,4530,7299,1109,205,713
,7679,5683,1838,2250,6253,2905,3845,7708,7948,6113
,1842,3356,4580,7986,3412,9576,5630,8208,5130,9767
,1525,3622,2097,1752,9422,881,9969,1683,1486,1614
,9492,450,5676,73,3530,2585,9020,3296,6599,7668
,3401,3758,6894,4236,3837,4532,826,6185,9262,6941
,46,1680,5807,717,985,4559,2581,6658,6877,8242
,9953,1779,2297,2133,334,6976,186,529,1457,7175
,1387,4027,2157,3994,6675,3428,655,895,1288,6145
,5338,842,1957,5108,8040,6458,6438,172,9824,2681
,5546,2020,9262,1918,7682,8574,3218,1703,5867,3895
,127,4856,7271,9597,5779,2133,5248,8746,1596,7387
,3862,2270,5420,5224,4924,7866,4788,1157,7519,1403
,2715,4263,38,830,5977,2342,4711,2585,5890,9568
,4637,496,1593,6650,3314,7191,5829,3486,6674,8001
,3224,4321,7611,7372,1072,5399,3012,7764,2612,5125
,3290,1063,2815,6717,4415,2485,6658,3364,2445,6981
,9911,5882,557,8145,2417,2871,8578,9621,3869,3368
,5017,9007,2100,2009,1596,4263,3854,6680,281,2616
,8076,8676,2813,1967,1687,5355,2739,4796,7869,5297
,9947,4572,6845,5958,7691,4654,9161,3830,2126,9701
,1463,7090,4339,9577,4787,765,4881,5757,5330,4380
,795,234,7741,2122,5151,6925,893,5489,9074,5576
,6173,8453,6280,8171,8255,5110,101,7834,8387,9840
,3020,241,173,9965,8703,7521,7847,899,6527,4665
,7063,3811,8616,8431,8170,5775,9366,8751,1997,2433
,7482,2638,8131,3144,506,591,5701,8648,1849,5500
,6660,1215,323,4056,1561,7305,2170,654,7844,2726
,5598,3800,615,285,7807,5019,5926,9949,4522,258
,6560,1498,2025,3795,306,9684,1687,4644,748,1886
,6998,5463,540,8266,3096,3957,7189,4424,8804,6787
,1339,6557,1156,5975,7548,9115,2430,7810,7571,4955
,9679,4257,6145,7997,6766,6858,9262,8385,8887,3143
,4958,136,9610,5536,6591,1305,404,2757,8621,6632
,2667,3733,4895,2705,2263,4002,9424,5614,6547,4618
,9668,1106,3902,3561,2314,7243,5767,9640,1559,9558
,1167,8901,9893,8711,3749,3532,1374,646,1308,3269
,7419,9243,7822,9305,5075,1482,7982,693,7808,5093
,4222,3254,8779,8714,6253,983,6630,4548,3090,9954
,3762,3517,7590,4729,7115,2924,3475,7262,1453,6600
,4870,8304,5145,7570,8330,1314,8441,3202,7375,8861
,4260,2866,9516,1531,1467,8093,5793,9335,656,5224
,2799,5612,2431,575,7219,3441,8187,8085,2853,4539
,3390,9481,154,676,3361,6924,8255,7575,1555,8175
,9505,1319,343,4245,6493,7262,4294,9554,1585,1430
,5954,4585,8956,4427,4131,1043,9115,7848,4672,9510
,5944,3177,3747,9600,6221,3197,3631,2619,1659,5898
,980,6716,3434,879,7620,4543,9214,8259,3822,3410
,2693,79,4086,7942,5623,4212,5423,5234,2343,764
,8132,2508,6810,986,9088,7271,2134,8679,7516,9967
,2605,4096,3279,9136,8225,354,7654,9071,1742,2335
,6615,9973,8178,8097,6616,608,6863,2778,2869,3461
,5963,5000,130,2394,9516,5781,5973,2806,6957,9935
,6580,4280,5154,9983,5014,5748,2940,2555,2006,3143
,8140,7302,9234,9557,7103,8295,5104,7896,6738,7938
,3033,6036,9039,3370,2227,4480,8122,5373,967,6516
,9750,9778,2384,870,3370,1370,2747,6864,6643,296
,2240,2071,2470,972,8242,2473,8530,3485,1115,5117
,9310,7505,2477,3271,633,8686,5988,4078,6691,7575
,631,8716,9577,1019,6492,5051,1316,6070,3042,2797
,8394,6389,9917,1167,8794,1158,202,9034,1523,6481
,6210,7586,8643,9291,7763,5480,9808,3759,2973,6501
,9286,199,1528,9717,5500,6472,465,2135,3052,1895
,2460,3859,7257,3647,6601,5744,1176,5674,1677,9553
,5142,94,1952,613,8799,1109,5453,2974,5625,1404
,4746,7061,9970,1058,220,9831,6582,8949,5867,7435
,2643,6659,7564,364,2295,4882,3854,1115,3677,2330
,9228,4342,8452,7138,9904,9513,3840,771,2111,6067
,7149,4432,2869,1070,2805,7965,3270,9372,1885,1262
,4259,6262,4150,8173,4916,2622,2569,2906,3238,2591
,361,8940,9418,3713,514,424,1627,9596,7829,6090
,4299,5070,3440,5656,8905,3842,1853,8731,7241,8652
,472,6224,7204,3929,1636,4250,1080,948,7143,533
,6316,5486,5289,3316,8809,7979,391,2765,8685,6175
,4828,4878,8579,296,3562,7888,4416,689,1176,1170
,8694,7983,1405,6648,6266,5749,9163,2702,2617,5653
,5079,574,4650,5112,2524,3270,3965,7453,7146,6974
,2640,4564,8900,4948,1514,2058,6577,3941,964,6922
,4839,3093,4193,7678,3747,5345,3005,7035,795,1343
,6090,7050,5439,5841,9803,6782,6129,6616,1448,2446
,9841,5863,5055,75,4107,4112,9666,668,1547,6627
,113,7856,6902,2314,300,8049,6560,5129,8985,3098
,593,7984,8062,5452,7285,9149,3338,5807,166,1165
,7820,3273,7537,2245,7491,8019,4511,183,9598,6439
,7536,8759,3424,8801,1428,6645,3577,9408,8906,8812
,5769,9252,2620,438,5094,1170,9681,3309,6816,7501
,8697,4730,9643,244,9299,8932,1512,3710,4176,973
,7872,9683,3605,3149,2460,5072,2481,3898,587,2069
,9849,9207,4918,809,939,6517,3751,4517,1689,1133
,1801,7176,5786,5124,3480,3673,4189,8737,8680,2461
,7164,4295,1051,712,8817,2610,8784,1979,4121,1886
,7893,6344,8451,9125,7995,3080,9611,4034,593,5807
,2371,5434,9854,144,5494,159,5895,3872,1268,4472
,558,9582,7537,7961,5697,9840,2235,9955,3958,4836
,413,8421,2056,2545,3773,1380,6563,1380,2700,802
,2184,5351,790,9025,2539,1719,1885,7648,3448,1153
,9600,8949,8707,388,9358,9784,8373,7378,2921,7995
,9544,8956,5418,1317,9640,985,4880,8783,2184,1020
,4268,4633,5086,3462,6009,4717,1418,7211,9020,5403
,2703,5829,8246,4982,4691,191,6689,7576,5642,3640
,9937,9543,7106,9650,3199,8384,7207,1976,832,4148
,6421,7313,8378,3340,5861,452,7089,5325,8053,1935
,962,1237,222,8213,6270,5383,72,4302,3593,9150
,4065,8937,2347,7413,8205,2231,7818,7437,1319,5831
,693,287,837,5571,9091,4734,1072,6634,3093,3659
,4007,1202,1774,2961,2568,8617,2734,2963,6412,8035
,4132,2318,205,3582,9212,4415,4404,2012,3338,6286
,8539,2862,3526,12,6993,1107,472,6629,7282,2321
,3084,2533,842,325,5518,8389,6303,7354,6701,536
,5274,6702,2369,4893,625,7888,9595,3364,7266,4306
,3822,2746,5430,3382,8392,6137,6452,9234,6581,6837
,1053,7824,6125,4759,121,4617,6257,5334,7990,4735
,7232,915,8221,5616,2366,4687,1888,2167,2558,7070
,8353,4423,3331,4628,8553,7703,4354,1472,777,5263
,1481,3170,8948,3457,1277,3149,3407,9389,8052,1606
,4190,1074,3391,6911,6815,89,8185,9513,555,6732
,7165,8348,9228,7679,5929,9745,4472,6138,475,8832
,1530,4508,9236,3441,7529,9531,7604,517,2261,9955
,4968,5020,1468,6683,4240,1337,2618,5433,3891,7183
,3189,1895,2477,9,1452,9384,5677,5909,9749,8999
,5818,1028,274,2280,3907,5463,3358,6361,4168,9674
,8247,1627,1065,3388,6385,1875,8841,7006,7193,6962
,3543,5509,6354,7968,7558,4865,6590,4851,6639,933
,946,6599,9443,873,8571,3893,9557,7048,2998,4257
,30,3433,2926,9718,407,4522,5503,6961,6257,6730
,2103,9987,1206,2305,6610,5265,1469,5730,6202,9392
,2877,2630,4626,9250,415,1179,7984,4658,249,6008
,3011,3532,4255,4607,7862,9539,7057,6234,5385,2255
,5551,3322,8909,9821,942,5383,522,4097,3273,5416
,1852,8321,8453,8811,7351,7265,7796,4760,75,9889
,44,157,9961,4499,5904,6008,4617,6404,5075,6338
,2594,8069,5784,9594,9175,1777,6813,2555,4650,4777
,2032,6735,5102,6950,7431,7290,5685,957,648,4427
,6406,4898,3007,7305,409,7471,4040,448,4753,5625
,8527,2645,3693,4716,6020,8359,4463,1167,2882,1634
,5559,7619,6810,2500,7515,591,3871,5879,6188,637
,8034,2992,8541,4997,3198,5267,919,2759,7725,740
,9833,2514,1472,2968,5243,2508,5321,2429,6336,3303
,3211,432,9810,2933,6668,5523,652,4557,1837,2390
,5425,6618,9016,3269,8042,5499,4680,1854,8052,677
,6022,9697,1419,2384,7975,5120,3807,1757,2750,4616
,6355,3498,1863,6761,3965,1033,669,8616,6078,4160
,5392,4635,9957,9213,2656,8070,6471,1716,1517,4879
,8370,1537,7993,131,1074,548,2097,6913,5947,2776
,7368,7734,6084,7065,2900,8435,4588,2231,7876,4594
,5353,4712,8598,429,6347,8734,8018,208,5390,8961
,7770,2155,8438,5651,2701,4855,361,2317,7902,6159
,8227,5878,8239,4594,7085,9317,385,3266,8240,6839
,7351,6267,41,1527,5517,7582,1158,5494,4163,2494
,6363,2546,7502,1494,4816,3333,9208,6681,841,3005
,9451,672,7209,1374,4425,8010,920,5564,8380,9066
,1485,5171,8156,6448,1704,9916,212,3907,951,9806
,155,7742,952,7785,4776,708,4068,4893,6578,8421
,4077,7924,807,8263,9455,9578,4988,793,9153,1121
,948,3647,885,7538,9355,7950,1905,5193,6745,7217
,2290,1981,5055,8764,719,9988,3654,7610,2756,646
,3871,2888,1633,2387,6033,6746,1527,803,8991,5756
,3345,1300,2151,4823,3002,4254,9,3585,2206,2669
,9179,5325,1736,2332,7927,8372,7226,4470,8198,13
,7443,902,151,2895,5070,1705,9191,3932,9989,5359
,5496,5712,5058,1412,6052,406,4399,5630,9181,6167
,4170,7658,1577,6042,5854,1173,7832,9379,2037,6541
,2471,5729,4690,5976,4481,1253,5950,1192,4344,7634
,1402,3561,3567,3474,5857,6771,6713,8208,1638,1979
,5934,8506,9358,5471,8000,7182,1204,8814,3833,4598
,6713,1516,536,2570,1061,6179,5922,777,5838,6160
,5554,5664,2329,5720,2265,1853,7302,2689,8197,6041
,1281,3614,9330,3416,9334,1422,2512,6557,4349,5569
,4993,6840,2818,4706,6454,8349,3118,1824,3538,4277
,6293,1921,6883,5836,9333,2150,653,3662,957,4479
,4566,1719,9893,848,8431,3710,5660,822,9175,1979
,1852,1751,375,8919,1913,1423,4289,879,7424,3224
,6391,4567,8881,3788,2395,5962,8976,3162,7793,1714
,8383,7453,9883,3054,4033,3991,2300,2199,9899,8984
,2051,1261,276,7671,9040,3647,5562,6981,8104,7971
,541,690,3543,4459,5162,7074,6151,3853,7821,9068
,2748,8820,1145,6923,8210,7857,267,3358,0,1697
,3613,1221,5203,2215,6183,3643,51,3836,5326,6692
,1959,7439,9031,4536,4056,6766,6699,7091,2214,7323
,2430,183,4581,7795,803,8203,3610,3943,5155,9261
,593,5016,8365,2846,2693,2654,6135,9978,2471,2299
,2769,5868,9919,7095,9457,5073,6994,4299,5055,9151
,4647,4185,9366,6817,2353,1450,8920,6604,145,9123
,5260,2012,3142,4967,5716,9170,8584,391,6695,6990
,5362,1849,9452,9822,6045,4752,8382,2615,1419,9872
,1793,8567,7512,2250,5191,9284,5128,2597,7060,7439
,1878,1209,7145,1923,6709,4365,7231,5506,6939,3237
,4425,4990,7786,5297,6939,3867,4400,8221,2368,7474
,6393,6297,8474,651,4872,9331,6467,7896,1968,4050
,6784,6021,2871,8015,7372,9308,356,6021,4470,7167
,1819,9006,5888,4292,8807,5457,6791,3314,9047,5316
,7977,9962,979,6387,6662,717,789,3240,9758,2965
,1936,8620,9655,7661,7187,7352,2504,4478,3146,2748
,8997,9465,7288,5510,7647,5207,7487,5141,571,3477
,4048,3850,1773,393,4240,2954,7919,4076,9325,1791
,1625,4805,4093,9121,7236,7674,8888,7034,9104,7746
,4142,7358,2374,7713,7408,561,6263,8049,2888,7161
,9843,9667,3465,1633,317,9077,5237,8810,3807,6041
,4544,2795,8632,3727,7503,8364,1088,1370,2037,4873
,3733,9425,2406,2663,6163,7223,6241,1972,8300,3129
,4072,4331,6167,7198,1361,6480,172,6329,3033,6769
,5889,1924,507,4066,7340,44,1228,9162,2775,4063
,696,8680,2954,9827,7001,1478,1928,3308,7850,7555
,320,761,103,9461,1107,1381,1799,6202,7900,2459
,6691,9642,5727,7038,1278,3415,4312,4068,4330,4328
,3859,1065,8928,6270,3330,9265,6988,6612,1230,1280
,6298,5123,8886,1256,42,5366,6226,7530,8841,8612
,65,7782,5274,242,4884,6696,918,8655,6111,6113
,5872,6675,5902,7689,795,5453,1424,8051,1431,881
,5633,6451,5646,2488,559,4928,2953,4857,3085,957
,6549,1522,3228,2609,7843,1381,4922,6210,3490,7599
,9299,6490,4917,9014,468,9247,360,4044,3797,6497
,9393,7095,6698,4135,9957,7464,1902,2088,7897,747
,3247,6974,8986,2746,3952,7253,3462,5873,7405,892
,3056,8059,439,5512,526,4158,9118,1051,1685,9854
,7013,4917,9934,8067,5988,9644,3295,7861,9479,3050
,3937,5848,8275,893,215,94,8800,2027,1193,6529
,3893,6055,3680,7847,6093,3492,1763,4919,3414,8415
,8833,695,7633,3622,2119,6610,5066,8290,9721,1494
,9851,8126,137,2973,9731,8029,4298,1381,4333,7242
,97,6162,5951,7012,9424,4777,2823,741,7690,4111
,4921,6650,5866,4381,2221,2926,5010,5537,5494,5385
,3297,6174,9581,7628,5557,4935,9178,3692,5297,4419
,7116,3212,9239,7585,5139,9074,4349,6660,7193,7574
,7370,4546,5199,1069,6847,8723,7338,3140,7668,7659
,8834,6243,8088,9713,5231,1868,9261,4546,8178,3195
,7275,7019,3709,248,7680,3610,3022,7555,2520,1310
,5765,4301,9864,9036,5812,6984,5838,1535,9548,4577
,9157,5789,6649,6175,8154,9925,3364,1160,311,4618
,8294,1851,4295,6995,676,8664,4483,7049,1161,7767
,7997,6538,5100,1235,4236,393,8321,9709,6902,628
,5412,7550,8539,2741,502,495,7558,4622,543,5816
,7770,7964,1088,4973,419,2159,4578,8772,8710,715
,1119,5023,4844,157,1762,8690,9547,1431,4291,4556
,4101,3815,1494,2371,4877,1325,1956,4514,363,1617
,3329,6148,700,7396,8123,7872,9709,323,1980,885
,9424,7421,4458,4634,7123,9979,2314,6977,4861,4961
,5282,6836,1498,8910,4356,9353,7233,4356,2571,3546
,632,8721,8286,2468,8164,5727,961,5862,6228,9301
,9442,5314,5687,9979,2741,1914,8897,3818,3317,6410
,9240,3796,2857,1863,3156,3723,560,8807,4669,4644
,3912,2902,2426,3748,1976,5090,9224,5770,1165,4254
,4039,6904,3528,2372,6562,1202,7530,2175,4228,9486
,1334,7299,1747,750,8580,4949,3136,6069,6668,1048
,6248,5004,7541,7896,9809,4509,961,4326,2943,337
,297,8362,7204,945,800,2373,1111,3902,389,729
,7179,4794,2928,9959,1443,8633,4012,1407,5501,3758
,9244,6386,1033,8247,5019,3839,6843,8818,1804,488
,8382,2240,9920,3498,9785,9236,7821,5628,8397,891
,2878,2889,1811,7556,4661,4701,7392,259,716,6549
,4314,4604,4850,5136,8086,7185,7911,6044,7590,4486
,1068,3889,4606,4292,1596,4974,5845,9590,1152,2449
,7483,4982,6562,3968,2188,5585,3096,1839,8656,8440
,255,5687,3637,6420,48,7608,6470,4632,7777,9824
,6113,9327,5314,4841,676,9305,6887,8103,9447,9820
,7357,3151,7430,8988,3001,9277,2373,6692,4795,1684
,4297,5989,4190,4134,7533,7017,1401,4116,5247,3400
,6181,491,6475,1153,1106,3656,5654,93,7357,8197
,4653,7738,2998,8044,7302,5720,3760,4130,6427,8690
,6320,4548,3379,5718,4085,7203,64,4209,5471,4972
,3479,6301,4685,3358,2737,7777,5006,648,8604,9466
,4568,569,5525,1156,4638,7441,6160,7993,400,3839
,8413,9391,4235,746,4962,440,1502,207,5293,5807
,8821,489,229,6148,4851,3738,8963,7010,3576,6129
,8587,239,82,531,6126,7887,8839,1655,3068,8617
,4484,3717,2394,6609,5101,588,8111,2967,8003,8456
,7282,9624,8013,979,4560,5753,8243,6942,9214,6665
,3379,411,4667,5223,5461,3396,519,5744,2163,999
,7088,406,7574,9075,2432,8155,5482,4388,1887,6111
,5152,7265,94,3474,9610,6755,5534,7929,6422,8283
,7554,4556,978,3807,5905,7231,2269,4477,2766,2539
,1173,5785,7282,6172,1233,5227,2589,1843,1939,2458
,5353,2686,4510,1945,7792,5167,174,8129,2213,5488
,952,3073,8045,8493,2934,6629,1364,9076,2068,9085
,6929,6084,2432,6325,2712,8728,7023,7485,6929,5484
,1035,5110,7571,5503,7639,7810,4437,2517,6268,5413
,3661,1243,3394,6626,4749,6291,5811,9190,107,3569
,6420,2534,7071,4192,2502,2932,2442,885,6508,1161
,9513,6891,9333,2658,7605,7376,6104,171,4092,3337
,4454,8920,8939,8006,5311,4254,1729,5761,6171,1802
,1196,3524,6887,135,7255,4676,7945,5918,5534,5458
,1248,1569,4405,3877,3395,5413,4515,1116,1465,4341
,820,5438,1295,8964,7110,8590,8265,1269,3048,4716
,576,4778,3694,1753,5033,7202,1543,5348,5325,5596
,1050,5257,2807,4019,5666,4254,9784,3688,7366,9536
,5286,5633,8683,6633,3354,5855,7237,5808,3820,2984
,2767,968,5589,8431,6664,1068,2419,9047,3997,4020
,1203,2279,8053,3096,2748,3826,7359,5834,5062,7795
,5219,5450,9128,9358,1744,4735,7192,9907,8382,2471
,3537,4711,4950,2330,7773,3072,9166,4282,609,982
,8681,8505,2142,6278,5605,1786,2633,6301,3547,6431
,5792,8048,7137,1668,4556,831,4065,7557,9372,1432
,9607,1393,8980,1762,3658,6614,3689,9014,265,4208
,1164,8319,9656,6616,4704,7907,2770,4142,4024,6757
,8292,3856,8535,4758,2183,1004,3130,5362,9709,2910
,6457,743,9976,5385,1710,9451,2955,1633,9901,6570
,9023,3657,5648,6373,984,6165,5453,7478,8608,2974
,8483,507,5657,5922,9856,8238,9419,6270,6413,8265
,2739,8607,5010,8152,8550,7261,3290,3089,6903,5200
,2971,6052,4502,5443,5622,454,6730,4964,950,5303
,2183,1096,7575,2862,9703,442,6315,8801,7906,279
,5969,4852,7216,2461,1592,3971,4392,9832,5283,7990
,9565,5126,9461,7773,5765,2378,2650,5875,954,826
,7758,1695,2558,1320,2860,9136,4495,5229,4477,6758
,6709,5843,3359,436,7203,2284,2767,8514,6564,5912
,9251,9466,5002,9225,5934,2046,1873,7274,8293,7949
,7720,1564,2439,6967,8794,6459,5901,4641,4093,8093
,902,2424,4890,5774,146,329,6763,5890,5096,2093
,4130,8312,6756,2828,7277,5309,8952,9182,1891,2945
,4114,1989,1090,4989,1557,1430,9955,9324,8261,4690
,2561,6849,2154,6109,1510,2886,7893,9843,9958,1089
,5143,5019,6151,9846,9362,3390,453,1190,5078,9494
,4880,2201,1677,3306,5126,8915,1673,5398,5102,2729
,1503,4594,3962,9308,4795,8126,5633,9991,8161,4291
,851,5695,9469,7606,1691,3326,8630,6465,8593,4681
,875,3295,9902,7857,2542,7214,3891,1154,9351,9183
,3299,9487,7188,9667,2356,3284,5388,8789,6320,9900
,2514,8986,3505,7520,4638,166,9811,1564,6123,7364
,5759,3594,2905,898,6021,2724,8273,9024,1448,9519
,1151,3097,3608,2408,6880,5221,1808,6588,495,8409
,2635,5428,2514,9240,1981,4377,7211,3012,9574,7372
,3404,1401,6013,5742,7730,2614,2298,9614,432,4050
,1859,1821,3638,7453,5091,4307,2140,6568,6380,7033
,6679,7300,3640,9385,9723,366,342,4078,3752,6456
,42,3564,2035,3887,3418,8938,1913,8756,7796,1342
,583,7603,9187,5875,3374,2563,6810,7996,4532,9021
,134,2432,502,5772,8398,4586,5705,7676,2651,4436
,823,811,279,2952,3578,135,2036,993,2016,9637
,1578,718,286,4997,7493,9491,6920,8740,7830,6286
,5618,7893,7132,597,8526,4140,5970,3841,2021,6482
,2970,3264,4986,6389,9346,8348,9597,5458,5930,9721
,4603,5570,2707,556,1105,1544,841,482,840,6297
,7210,1991,6960,8495,1438,9341,7315,2715,5420,9964
,234,2098,5362,8373,2803,3503,6306,2565,1653,5168
,9163,2934,6234,6866,244,3667,4602,2556,3293,6662
,1696,5545,4016,7923,121,6141,7113,6476,3431,1811
,5810,5767,1906,9835,3890,7576,838,2464,222,8416
,1309,4578,5796,8444,3474,3839,3252,2865,2340,3346
};

/**
   Infelizmente, nao deu tempo de calcular markowitz... Os Dados 
   ja estao prontos e estao na estrutura "myPapeis", porem nao deu
   tempo, vamos ter que fazer uma simulacao randomizando...

*/

globle int CalculateMarkowitz(void *theEnv){
    DATA_OBJECT ret2,theResult;
	int f,g;
	char Temp4[1000],Temp[1000],NomePregao[1000];
	int retorno;
	int *Porcentagens;
	FILE *templog;

	Porcentagens=malloc(sizeof(int)*1000);

	if(count==0) count=(GetTickCount() % 1000);

	srand(count);
	currentCombinacao=0;

	templog=fopen("C:\\testeCalculate.txt","a");
	fprintf(templog,"Calculando para:%d",ValoresRandomicos[count]/10);
	fclose(templog);


	Combinacao=ValoresRandomicos[count]*10;//(rand() % 50);
	CalcularPorcentagens(0,Porcentagens);

	count++;
	retorno=(rand() % 22)-10;

	
	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(NomePregao,"%s",DOToString(theResult));


    sprintf(Temp,"(make-instance NovoPortfolio%d of NOVOPORTFOLIO (RetornoEsperado %d)(Pregao %s))",count,retorno,NomePregao);
	f=Eval(theEnv,Temp,&ret2);

	for(f=0;f<myPapeis.NumeroPapeis;f++){
	    sprintf(Temp,"(make-instance NovoPapelEmPortfolio%d of NOVOPAPELEMPORTFOLIO (Papel %d) (Porcentagem %d)(Pregao %s))",myPapeis.myQuotes[f]->Papel,count,Porcentagens[f+1],NomePregao);
	    g=Eval(theEnv,Temp,&ret2);
	}
	return 1;
}



globle int WriteToBlackboard(void *theEnv){
	DATA_OBJECT theResult;
	char Temp         [10000];
	char Temp2        [10000];
	char Message      [10000];
	char TempToken    [10000];
	char TempToken2   [10000];
	char TempKey      [10000];
	char TempValue    [10000];
	char TempProperty [10000];
	

	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));
	
	EnvRtnUnknown(theEnv,2,&theResult);
	sprintf(Temp2,"%s",DOToString(theResult));

	sprintf(Message,"<Message Type=\"GetAnalisysResponse\">\r\n<AgentData ClassName=\"%s\">\r\n",Temp);
	strcpy(TempToken,Temp2);
	while(1){
		if(strstr(TempToken,";")==NULL) break;
		strcpy(TempToken2,TempToken);
		*strstr(TempToken2,";")=0;
		strcpy(TempKey,TempToken2);
		*strstr(TempKey,"=")=0;
		strcpy(TempValue,strstr(TempToken2,"=")+1);
		sprintf(TempProperty,"<Property Name=\"%s\" Value=\"%s\" />\r\n",TempKey,TempValue);
		strcat(Message,TempProperty);
		strcpy(TempToken2,strstr(TempToken,";")+1);
		strcpy(TempToken,TempToken2);
	}
	if(strlen(TempToken)>0){
		strcpy(TempToken2,TempToken);
		strcpy(TempKey,TempToken2);
		*strstr(TempKey,"=")=0;
		strcpy(TempValue,strstr(TempToken2,"=")+1);
		sprintf(TempProperty,"<Property Name=\"%s\" Value=\"%s\" />\r\n",TempKey,TempValue);
		strcat(Message,TempProperty);
	}
	strcat(Message,"</AgentData>\r\n");
	strcat(Message,"</Message>\r\n");
	OutputDebugString(Message);
    addAnalisysMade(Message);
	return 0;
}

globle int Message(void *theEnv){
	DATA_OBJECT theResult;
	int f;
	char Temp[10000],Temp2[10000];
     
	EnvRtnUnknown(theEnv,1,&theResult);
	sprintf(Temp,"%s",DOToString(theResult));

	EnvRtnUnknown(theEnv,2,&theResult);
	sprintf(Temp2,"%s",DOToString(theResult));
	
	MessageBox(NULL,Temp,Temp2,48);
	f=0;
	
	return 1;
}


globle int CloseFunction(
  void *theEnv)
  {
   int numberOfArguments;
   char *logicalName;

   /*======================================*/
   /* Check for valid number of arguments. */
   /*======================================*/

   if ((numberOfArguments = EnvArgCountCheck(theEnv,"close",NO_MORE_THAN,1)) == -1) return(0);

   /*=====================================================*/
   /* If no arguments are specified, then close all files */
   /* opened with the open command. Return TRUE if all    */
   /* files were closed successfully, otherwise FALSE.    */
   /*=====================================================*/

   if (numberOfArguments == 0) return(CloseAllFiles(theEnv));

   /*================================*/
   /* Get the logical name argument. */
   /*================================*/

   logicalName = GetLogicalName(theEnv,1,NULL);
   if (logicalName == NULL)
     {
      IllegalLogicalNameMessage(theEnv,"close");
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      return(0);
     }

   /*========================================================*/
   /* Close the file associated with the specified logical   */
   /* name. Return TRUE if the file was closed successfully, */
   /* otherwise false.                                       */
   /*========================================================*/

   return(CloseFile(theEnv,logicalName));
  }


#endif

#if EXT_IO

/****************************************/
/* RemoveFunction: H/L access routine   */
/*   for the remove function.           */
/****************************************/
globle int RemoveFunction(
  void *theEnv)
  {
   char *theFileName;

   /*======================================*/
   /* Check for valid number of arguments. */
   /*======================================*/

   if (EnvArgCountCheck(theEnv,"remove",EXACTLY,1) == -1) return(FALSE);

   /*====================*/
   /* Get the file name. */
   /*====================*/

   if ((theFileName = GetFileName(theEnv,"remove",1)) == NULL) return(FALSE);

   /*==============================================*/
   /* Remove the file. Return TRUE if the file was */
   /* sucessfully removed, otherwise FALSE.        */
   /*==============================================*/

   return(genremove(theFileName));
  }

/****************************************/
/* RenameFunction: H/L access routine   */
/*   for the rename function.           */
/****************************************/
globle int RenameFunction(
  void *theEnv)
  {
   char *oldFileName, *newFileName;

   /*========================================*/
   /* Check for a valid number of arguments. */
   /*========================================*/

   if (EnvArgCountCheck(theEnv,"rename",EXACTLY,2) == -1) return(FALSE);

   /*===========================*/
   /* Check for the file names. */
   /*===========================*/

   if ((oldFileName = GetFileName(theEnv,"rename",1)) == NULL) return(FALSE);
   if ((newFileName = GetFileName(theEnv,"rename",2)) == NULL) return(FALSE);

   /*==============================================*/
   /* Rename the file. Return TRUE if the file was */
   /* sucessfully renamed, otherwise FALSE.        */
   /*==============================================*/

   return(genrename(oldFileName,newFileName));
  }

/****************************************/
/* FormatFunction: H/L access routine   */
/*   for the format function.           */
/****************************************/
globle void *FormatFunction(
  void *theEnv)
  {
   int argCount;
   unsigned start_pos;
   char *formatString, *logicalName;
   char formatFlagType;
   int  f_cur_arg = 3;
   unsigned form_pos = 0;
   char buffer[FORMAT_MAX];
   char percentBuffer[FLAG_MAX];
   char *fstr = NULL;
   unsigned fmax = 0;
   int fpos = 0;
   void *hptr;
   int longFound;
   char *theString;

   /*======================================*/
   /* Set default return value for errors. */
   /*======================================*/

   hptr = EnvAddSymbol(theEnv,"");

   /*=========================================*/
   /* Format requires at least two arguments: */
   /* a logical name and a format string.     */
   /*=========================================*/

   if ((argCount = EnvArgCountCheck(theEnv,"format",AT_LEAST,2)) == -1)
     { return(hptr); }

   /*========================================*/
   /* First argument must be a logical name. */
   /*========================================*/

   if ((logicalName = GetLogicalName(theEnv,1,"stdout")) == NULL)
     {
      IllegalLogicalNameMessage(theEnv,"format");
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      return(hptr);
     }

   if (strcmp(logicalName,"nil") == 0)
     { /* do nothing */ }
   else if (QueryRouters(theEnv,logicalName) == FALSE)
     {
      UnrecognizedRouterMessage(theEnv,logicalName);
      return(hptr);
     }

   /*=====================================================*/
   /* Second argument must be a string.  The appropriate  */
   /* number of arguments specified by the string must be */
   /* present in the argument list.                       */
   /*=====================================================*/

   if ((formatString = ControlStringCheck(theEnv,argCount)) == NULL)
     { return (hptr); }

   /*==============================================*/
   /* Locate a string of 80 character for scanning */
   /* sub_string from control_string               */
   /*==============================================*/

   /* Scanning and print the format */

   while (formatString[form_pos] != '\0')
     {
      if (formatString[form_pos] != '%')
        {
         start_pos = form_pos;
         while ((formatString[form_pos] != '%') &&
                (formatString[form_pos] != '\0') &&
                ((form_pos - start_pos) < FLAG_MAX))
           { form_pos++; }
         fstr = AppendNToString(theEnv,&formatString[start_pos],fstr,form_pos-start_pos,&fpos,&fmax);
        }
      else
        {
         start_pos = form_pos;
         form_pos++;
         formatFlagType = FindFormatFlag(formatString,&form_pos,buffer,&longFound);
         if (formatFlagType != ' ')
           {
            strncpy(percentBuffer,&formatString[start_pos],
                    (STD_SIZE) form_pos-start_pos);
            percentBuffer[form_pos-start_pos] = EOS;
            if ((! longFound) &&
                ((formatFlagType == 'd') || (formatFlagType == 'o') ||
                 (formatFlagType == 'u') || (formatFlagType == 'x')))
              {
               longFound = TRUE;
               percentBuffer[(form_pos-start_pos) - 1] = 'l';
               percentBuffer[form_pos-start_pos] = formatFlagType;
               percentBuffer[(form_pos-start_pos) + 1] = EOS;
              }

            if ((theString = PrintFormatFlag(theEnv,percentBuffer,f_cur_arg,formatFlagType,longFound)) == NULL)
              {
               if (fstr != NULL) rm(theEnv,fstr,fmax);
               return (hptr);
              }
            fstr = AppendToString(theEnv,theString,fstr,&fpos,&fmax);
            if (fstr == NULL) return(hptr);
            f_cur_arg++;
           }
         else
           {
            fstr = AppendToString(theEnv,buffer,fstr,&fpos,&fmax);
            if (fstr == NULL) return(hptr);
           }
        }
     }

   if (fstr != NULL)
     {
      hptr = EnvAddSymbol(theEnv,fstr);
      if (strcmp(logicalName,"nil") != 0) EnvPrintRouter(theEnv,logicalName,fstr);
      rm(theEnv,fstr,fmax);
     }
   else
     { hptr = EnvAddSymbol(theEnv,""); }

   return(hptr);
  }

/*********************************************************************/
/* ControlStringCheck:  Checks the 2nd parameter which is the format */
/*   control string to see if there are enough matching arguments.   */
/*********************************************************************/
static char *ControlStringCheck(
  void *theEnv,
  int argCount)
  {
   DATA_OBJECT t_ptr;
   char *str_array;
   char print_buff[10];
   int longFound;
   unsigned i;
   int per_count;

   if (EnvArgTypeCheck(theEnv,"format",2,STRING,&t_ptr) == FALSE) return(NULL);

   per_count = 0;
   str_array = ValueToString(t_ptr.value);
   for (i= 0 ; str_array[i] != '\0' ; )
     {
      if (str_array[i] == '%')
        {
         i++;
         if (FindFormatFlag(str_array,&i,print_buff,&longFound) != ' ')
           { per_count++; }
        }
      else
        { i++; }
     }

   if (per_count != (argCount - 2))
     {
      ExpectedCountError(theEnv,"format",EXACTLY,per_count+2);
      SetEvaluationError(theEnv,TRUE);
      return (NULL);
     }

   return(str_array);
  }

/***********************************************/
/* FindFormatFlag:  This function searches for */
/*   a format flag in the format string.       */
/***********************************************/
static char FindFormatFlag(
  char *formatString,
  unsigned *a,
  char *formatBuffer,
  int *longFound)
  {
   char inchar, formatFlagType;
   unsigned start_pos, copy_pos = 0;

   /*===========================================================*/
   /* Set return values to the default value. A blank character */
   /* indicates that no format flag was found which requires a  */
   /* parameter. The longFound flag indicates whether the       */
   /* character 'l' was used with the float or integer flag to  */
   /* indicate a double precision float or a long integer.      */
   /*===========================================================*/

   formatFlagType = ' ';
   *longFound = FALSE;

   /*=====================================================*/
   /* The format flags for carriage returns, line feeds,  */
   /* horizontal and vertical tabs, and the percent sign, */
   /* do not require a parameter.                         */
   /*=====================================================*/

   if (formatString[*a] == 'n')
     {
      sprintf(formatBuffer,"\n");
      (*a)++;
      return(formatFlagType);
     }
   else if (formatString[*a] == 'r')
     {
      sprintf(formatBuffer,"\r");
      (*a)++;
      return(formatFlagType);
     }
   else if (formatString[*a] == 't')
     {
      sprintf(formatBuffer,"\t");
      (*a)++;
      return(formatFlagType);
     }
   else if (formatString[*a] == 'v')
     {
      sprintf(formatBuffer,"\v");
      (*a)++;
      return(formatFlagType);
     }
   else if (formatString[*a] == '%')
     {
      sprintf(formatBuffer,"%%");
      (*a)++;
      return(formatFlagType);
     }

   /*======================================================*/
   /* Identify the format flag which requires a parameter. */
   /*======================================================*/

   start_pos = *a;
   formatBuffer[copy_pos] = '\0';
   while ((formatString[*a] != '%') &&
          (formatString[*a] != '\0') &&
          ((*a - start_pos) < FLAG_MAX))
     {
      inchar = formatString[*a];
      formatBuffer[copy_pos++] = inchar;
      formatBuffer[copy_pos] = '\0';
      if ( (inchar == 'd') ||
           (inchar == 'o') ||
           (inchar == 'x') ||
           (inchar == 'u') ||
           (inchar == 'c') ||
           (inchar == 's') ||
           (inchar == 'e') ||
           (inchar == 'f') ||
           (inchar == 'g') )
        {
         formatFlagType = inchar;
         if (formatString[(*a) - 1] == 'l')
           { *longFound = TRUE; }
         (*a)++;
         return(formatFlagType);
        }
      (*a)++;
     }

   return(formatFlagType);
  }

/**********************************************************************/
/* PrintFormatFlag:  Prints out part of the total format string along */
/*   with the argument for that part of the format string.            */
/**********************************************************************/
static char *PrintFormatFlag(
  void *theEnv,
  char *formatString,
  int whichArg,
  int formatType,
  int longFound)
  {
   DATA_OBJECT theResult;
   char *theString, *printBuffer;
   unsigned theLength;

   /*=================*/
   /* String argument */
   /*=================*/

   switch (formatType)
     {
      case 's':
        if (EnvArgTypeCheck(theEnv,"format",whichArg,SYMBOL_OR_STRING,&theResult) == FALSE) return(NULL);
        theLength = strlen(formatString) + strlen(ValueToString(theResult.value)) + 200;
        printBuffer = (char *) gm2(theEnv,(sizeof(char) * theLength));
        sprintf(printBuffer,formatString,ValueToString(theResult.value));
        break;

      case 'c':
        EnvRtnUnknown(theEnv,whichArg,&theResult);
        if ((GetType(theResult) == STRING) ||
            (GetType(theResult) == SYMBOL))
          {
           theLength = strlen(formatString) + 200;
           printBuffer = (char *) gm2(theEnv,(sizeof(char) * theLength));
           sprintf(printBuffer,formatString,(ValueToString(theResult.value))[0]);
          }
        else if (GetType(theResult) == INTEGER)
          {
           theLength = strlen(formatString) + 200;
           printBuffer = (char *) gm2(theEnv,(sizeof(char) * theLength));
           sprintf(printBuffer,formatString,(char) DOToLong(theResult));
          }
        else
          {
           ExpectedTypeError1(theEnv,"format",whichArg,"symbol, string, or integer");
           return(NULL);
          }
        break;

      case 'd':
      case 'x':
      case 'o':
      case 'u':
        if (EnvArgTypeCheck(theEnv,"format",whichArg,INTEGER_OR_FLOAT,&theResult) == FALSE) return(NULL);
        theLength = strlen(formatString) + 200;
        printBuffer = (char *) gm2(theEnv,(sizeof(char) * theLength));
        if (GetType(theResult) == FLOAT)
          {
           if (longFound)
             { sprintf(printBuffer,formatString,(long) ValueToDouble(theResult.value)); }
           else
             { sprintf(printBuffer,formatString,(int) ValueToDouble(theResult.value)); }
          }
        else
          {
           if (longFound)
             { sprintf(printBuffer,formatString,(long) ValueToLong(theResult.value)); }
           else
             { sprintf(printBuffer,formatString,(int) ValueToLong(theResult.value)); }
          }
        break;

      case 'f':
      case 'g':
      case 'e':
        if (EnvArgTypeCheck(theEnv,"format",whichArg,INTEGER_OR_FLOAT,&theResult) == FALSE) return(NULL);
        theLength = strlen(formatString) + 200;
        printBuffer = (char *) gm2(theEnv,(sizeof(char) * theLength));

        if (GetType(theResult) == FLOAT)
          { sprintf(printBuffer,formatString,ValueToDouble(theResult.value)); }
        else
          { sprintf(printBuffer,formatString,(double) ValueToLong(theResult.value)); }
        break;

      default:
         EnvPrintRouter(theEnv,WERROR," Error in format, the conversion character");
         EnvPrintRouter(theEnv,WERROR," for formatted output is not valid\n");
         return(FALSE);
     }

   theString = ValueToString(EnvAddSymbol(theEnv,printBuffer));
   rm(theEnv,printBuffer,sizeof(char) * theLength);
   return(theString);
  }

/******************************************/
/* ReadlineFunction: H/L access routine   */
/*   for the readline function.           */
/******************************************/
globle void ReadlineFunction(
  void *theEnv,
  DATA_OBJECT_PTR returnValue)
  {
   char *buffer;
   unsigned line_max = 0;
   int numberOfArguments;
   char *logicalName;

   returnValue->type = STRING;

   if ((numberOfArguments = EnvArgCountCheck(theEnv,"readline",NO_MORE_THAN,1)) == -1)
     {
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
      return;
     }

   if (numberOfArguments == 0 )
     { logicalName = "stdin"; }
   else
     {
      logicalName = GetLogicalName(theEnv,1,"stdin");
      if (logicalName == NULL)
        {
         IllegalLogicalNameMessage(theEnv,"readline");
         SetHaltExecution(theEnv,TRUE);
         SetEvaluationError(theEnv,TRUE);
         returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
         return;
        }
     }

   if (QueryRouters(theEnv,logicalName) == FALSE)
     {
      UnrecognizedRouterMessage(theEnv,logicalName);
      SetHaltExecution(theEnv,TRUE);
      SetEvaluationError(theEnv,TRUE);
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
      return;
     }

   RouterData(theEnv)->CommandBufferInputCount = 0;
   buffer = FillBuffer(theEnv,logicalName,&RouterData(theEnv)->CommandBufferInputCount,&line_max);
   RouterData(theEnv)->CommandBufferInputCount = -1;

   if (GetHaltExecution(theEnv))
     {
      returnValue->value = (void *) EnvAddSymbol(theEnv,"*** READ ERROR ***");
      if (buffer != NULL) rm(theEnv,buffer,(int) sizeof (char) * line_max);
      return;
     }

   if (buffer == NULL)
     {
      returnValue->value = (void *) EnvAddSymbol(theEnv,"EOF");
      returnValue->type = SYMBOL;
      return;
     }

   returnValue->value = (void *) EnvAddSymbol(theEnv,buffer);
   rm(theEnv,buffer,(int) sizeof (char) * line_max);
   return;
  }

/*************************************************************/
/* FillBuffer: Read characters from a specified logical name */
/*   and places them into a buffer until a carriage return   */
/*   or end-of-file character is read.                       */
/*************************************************************/
static char *FillBuffer(
  void *theEnv,
  char *logicalName,
  int *currentPosition,
  unsigned *maximumSize)
  {
   int c;
   char *buf = NULL;

   /*================================*/
   /* Read until end of line or eof. */
   /*================================*/

   c = EnvGetcRouter(theEnv,logicalName);

   if (c == EOF)
     { return(NULL); }

   /*==================================*/
   /* Grab characters until cr or eof. */
   /*==================================*/

   while ((c != '\n') && (c != '\r') && (c != EOF) &&
          (! GetHaltExecution(theEnv)))
     {
      buf = ExpandStringWithChar(theEnv,c,buf,currentPosition,maximumSize,*maximumSize+80);
      c = EnvGetcRouter(theEnv,logicalName);
     }

   /*==================*/
   /* Add closing EOS. */
   /*==================*/

   buf = ExpandStringWithChar(theEnv,EOS,buf,currentPosition,maximumSize,*maximumSize+80);
   return (buf);
  }
#endif

#if BASIC_IO || EXT_IO

/****************************************************/
/* IllegalLogicalNameMessage: Generic error message */
/*   for illegal logical names.                     */
/****************************************************/
static void IllegalLogicalNameMessage(
  void *theEnv,
  char *theFunction)
  {
   PrintErrorID(theEnv,"IOFUN",1,FALSE);
   EnvPrintRouter(theEnv,WERROR,"Illegal logical name used for ");
   EnvPrintRouter(theEnv,WERROR,theFunction);
   EnvPrintRouter(theEnv,WERROR," function.\n");
  }

#endif

